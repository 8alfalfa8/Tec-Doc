# 🛡️ セキュリティ・監査設計ガイドライン
「**セキュリティ・監査設計ガイドライン**」は、システムの企画・設計段階で「安全性（Security）」と「説明責任（Auditability）」を**両立**させるための基準書にあたります。

以下では、

> ✅ 目的・適用範囲 → 基本原則 → 設計項目 → 監査設計項目 → 運用・改善
> の順に体系的に整理します。

---

## 1. 🎯 **目的と適用範囲**

### 目的

本ガイドラインは、システム開発・運用において情報資産の**機密性（Confidentiality）・完全性（Integrity）・可用性（Availability）**を確保し、同時に**説明責任（Accountability）**を実現するための設計方針を定める。

### 適用範囲

* 新規開発・機能改修・クラウド移行案件すべて
* 対象：アプリケーション層、データ層、インフラ層、ネットワーク層、運用管理層

---

## 2. ⚖️ **基本原則（設計思想）**

| 原則名            | 説明                         |
| -------------- | -------------------------- |
| 最小権限の原則        | 各主体（ユーザー・プロセス）に必要最小限の権限を付与 |
| 多層防御           | 各層で防御を重ね、単一障害点を排除          |
| 安全なデフォルト       | 初期設定時に安全状態を確保              |
| セキュリティ・バイ・デザイン | 要件定義からセキュリティを組み込む          |
| 完全仲介           | すべてのアクセス要求を毎回検証            |
| 公開設計           | セキュリティを秘密設計に依存しない          |
| フェイルセーフ        | 障害発生時は安全側で停止               |
| 説明責任           | 操作・変更・アクセスの証跡を明確化          |
| 改ざん防止          | 証跡を削除・改ざんできない構造            |
| 継続的改善          | 運用監査・脆弱性情報を反映し更新           |

---

## 3. 🔐 **セキュリティ設計項目**

| 区分        | 設計対象           | 要点                             |
| --------- | -------------- | ------------------------------ |
| 認証        | ユーザー認証、MFA、SSO | ID連携（OIDC/SAML）、パスワード管理、MFA必須化 |
| 認可        | RBAC/ABAC、権限分離 | 管理者・利用者・監査者を明確分離               |
| 通信        | HTTPS/TLS設定    | 強制HTTPS、TLS1.2以上、HSTS          |
| データ保護     | 保存データ暗号化       | AES-256またはKMS管理キー利用            |
| 入出力検証     | Webフォーム/API入力  | SQLi、XSS、CSRF防止、正規表現検証         |
| ログ管理      | セキュリティ・操作ログ    | 統一形式（JSON等）、不可逆保存、転送暗号化        |
| エラーハンドリング | 情報漏えい防止        | スタックトレース非表示、一般化メッセージ           |
| パッチ適用     | OS/ミドルウェア更新    | 自動更新または月次適用サイクル                |
| アカウント管理   | アカウントライフサイクル   | 作成・変更・削除の承認プロセス整備              |
| 開発環境      | 機密情報除外         | APIキー・パスワードをソース管理に含めない         |
| インフラ構成    | ネットワーク分離       | DMZ構成、VPCサブネット分離、SG最小化         |
| 監視・検知     | IDS/WAF/ログ監視   | 不正アクセス検知とアラート連携                |

---

## 4. 🧾 **監査設計項目**

| 区分     | 設計対象        | 要点                             |
| ------ | ----------- | ------------------------------ |
| 操作証跡   | 業務操作・設定変更   | 「誰が・いつ・何をしたか」を記録（ユーザーID・IP・時刻） |
| ログ完全性  | 改ざん防止       | WORM/S3バージョニング、署名ハッシュ          |
| 一貫性    | トランザクションID  | アプリ～DB～インフラログの紐づけ              |
| 独立性    | ログ分離        | アプリサーバと監査サーバを分離、読み取り専用化        |
| 保持管理   | 保存期間・削除ポリシー | 法規・監査基準に基づく保持（例：7年）            |
| 監査容易性  | 検索・出力形式     | JSON・CSV・SIEM連携で統一フォーマット       |
| アクセス制御 | ログ閲覧権限      | 閲覧・出力を監査担当者のみに制限               |
| 可視化    | 監査ダッシュボード   | 重要イベント（削除・承認・設定変更）を自動検出        |
| アラート連携 | 不正検知        | SIEMやGuardDutyでリアルタイム通知        |
| 再現性    | 状態復元        | ログ＋設定履歴で業務処理を再現可能にする           |

---

## 5. 🏗️ **アーキテクチャ設計例**

### クラウド（AWS）の場合

| 領域       | サービス                              | 設計ポイント                  |
| -------- | --------------------------------- | ----------------------- |
| 監査ログ     | AWS CloudTrail                    | APIコール履歴（すべてのリージョンで有効化） |
| 構成監視     | AWS Config                        | リソース変更履歴と準拠性チェック        |
| セキュリティ監視 | AWS Security Hub / GuardDuty      | リアルタイム脅威検知と統合ビュー        |
| ログ保存     | S3（バージョニング有効）                     | 変更・削除不可ポリシー適用           |
| 分析       | CloudWatch Logs Insights / Athena | 検索・分析クエリ活用              |
| IAM管理    | IAM Roles, SCP                    | 権限分離・最小権限原則の強制          |

---

## 6. ⚙️ **運用・改善プロセス**

| 工程         | 内容                 | 頻度          |
| ---------- | ------------------ | ----------- |
| セキュリティレビュー | 設計段階のリスク評価（脆弱性/権限） | 各開発フェーズ     |
| 監査証跡確認     | ログ取得・整合性・改ざん検証     | 月次 or リリース前 |
| 脆弱性診断      | アプリ・ネットワーク診断       | 半期ごと        |
| 権限棚卸       | IAM・RBACレビュー       | 四半期ごと       |
| インシデント演習   | 想定攻撃対応訓練           | 年1回以上       |
| 改善報告       | 対応履歴・再発防止策共有       | 継続的         |

---

## 7. 📚 **参照基準**

| 分類   | 基準/ガイドライン                      | 対応項目           |
| ---- | ------------------------------ | -------------- |
| 国際規格 | ISO/IEC 27001 / 27002          | 情報セキュリティ管理全般   |
| 政府基準 | NIST SP 800-53, 800-92         | ログ監査・アカウンタビリティ |
| 国内指針 | 経済産業省「システム管理基準」                | 内部統制・J-SOX     |
| クラウド | AWS Well-Architected Framework | セキュリティ/運用優秀性   |
| 開発   | OWASP ASVS / Top10             | アプリケーション脆弱性対策  |

---

## 8. 🧩 **成熟度モデル（Maturity Model）**

| レベル       | 状況            | 特徴       |
| --------- | ------------- | -------- |
| Lv1: 対応なし | ログなし・属人的管理    | 事後追跡不可   |
| Lv2: 最低限  | ログ取得あり・未統合    | 証跡断片化    |
| Lv3: 構造化  | ログ統合・権限管理整備   | 監査可能状態   |
| Lv4: 自動化  | SIEM・アラート自動通知 | 検知と対応連携  |
| Lv5: 最適化  | 継続改善・AI分析     | リスク先読み対応 |

---

## 9. ✅ **設計チェックリスト（抜粋）**

| No | 項目     | 確認内容                | 対応状況  |
| -- | ------ | ------------------- | ----- |
| 1  | 認証方式   | MFAまたはSSOが導入されているか  | □済 □未 |
| 2  | IAM権限  | 最小権限設計になっているか       | □済 □未 |
| 3  | 通信経路   | 全通信がTLS1.2以上か       | □済 □未 |
| 4  | ログ統一   | 全層でトランザクションID連携があるか | □済 □未 |
| 5  | 改ざん防止  | WORMまたはハッシュ保護されているか | □済 □未 |
| 6  | 保持期間   | ログ保存期間が法基準を満たすか     | □済 □未 |
| 7  | 権限棚卸   | 管理者・監査者が分離されているか    | □済 □未 |
| 8  | 監査性    | 検索・抽出が容易か（監査人視点）    | □済 □未 |
| 9  | 可用性    | 障害時に安全側で動作するか       | □済 □未 |
| 10 | 改善サイクル | 年次レビューと更新が実施されているか  | □済 □未 |

---

## 💡 補足

* 本ガイドラインは**RFP・基本設計書・運用設計書**に反映可能です。
* クラウド（AWS/Azure/GCP）・オンプレミスどちらにも適用可。
* 必要に応じて「セキュリティ・監査設計テンプレート（ExcelまたはWord）」形式で成果物化可能。

---

