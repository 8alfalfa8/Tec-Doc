# ◆ CSIRT（Computer Security Incident Response Team）構築における具体的作業

以下では、**企業内CSIRT（Computer Security Incident Response Team）構築**について、
**実務レベルで「何を・何を使って・どうやって・何を作るか」**が分かるように、
**工程別・作業タスク別**に詳しく整理します。
（※IT統制・監査・AWS/オンプレ経験がある方が、RFP・設計・運用説明にそのまま使える粒度です）

---

## 1. CSIRT構築の全体像

### フェーズ構成

```
① 企画・方針策定
② 体制設計
③ プロセス設計（対応フロー）
④ 技術基盤設計・導入
⑤ ルール・ドキュメント整備
⑥ 教育・訓練
⑦ 本番運用・改善
```

---

## 2. フェーズ① 企画・方針策定

### 作業タスク①-1：CSIRT設置目的・スコープ定義

| 項目       | 内容                                             |
| -------- | ---------------------------------------------- |
| **入力情報** | 経営方針、事業戦略、業界ガイドライン（NISC、IPA、NIST CSF）、過去インシデント |
| **作業内容** | CSIRTの役割（予防／検知／対応／再発防止）を明確化                    |
| **方法**   | 経営層・IT・法務・リスク管理部門とのワークショップ                     |
| **成果物**  | CSIRT設置方針書、スコープ定義書                             |
| **注意事項** | 「何でも対応するCSIRT」にしない（責任肥大化防止）                    |

#### スコープ例

* 対象：社内IT、クラウド、委託先
* 対応事象：マルウェア、情報漏えい、不正アクセス等
* 非対象：業務トラブル、性能問題

---

### 作業タスク①-2：成熟度（レベル）定義

| 項目       | 内容                   |
| -------- | -------------------- |
| **入力情報** | 組織規模、予算、人員           |
| **作業内容** | CSIRT成熟度モデルの決定       |
| **方法**   | NIST CSF / SIM3 等の適用 |
| **成果物**  | CSIRT成熟度定義資料         |
| **注意事項** | 初年度から「フルSOC連携」を狙わない  |

成熟度例：

* Lv1：窓口・初動対応のみ
* Lv2：分析・報告・再発防止
* Lv3：SOC連携・脅威ハンティング

---

## 3. フェーズ② 体制設計

### 作業タスク②-1：CSIRT組織・役割定義

| 項目       | 内容              |
| -------- | --------------- |
| **入力情報** | 組織図、既存役割        |
| **作業内容** | 役割分担（責任範囲）の明確化  |
| **方法**   | RACIチャート作成      |
| **成果物**  | CSIRT体制図、役割定義書  |
| **注意事項** | 属人化防止、代替要員を必ず定義 |

#### 代表的役割

| 役割         | 主な責務      |
| ---------- | --------- |
| CSIRT責任者   | 意思決定・経営報告 |
| インシデント対応担当 | 初動・封じ込め   |
| 技術分析担当     | ログ解析・原因特定 |
| 法務・広報      | 対外対応・法的判断 |

---

### 作業タスク②-2：外部連携定義

| 項目       | 内容                       |
| -------- | ------------------------ |
| **入力情報** | ベンダ契約、委託範囲               |
| **作業内容** | SOC、MSS、警察、JPCERT/CC連携定義 |
| **方法**   | 契約条件・連絡フロー整理             |
| **成果物**  | 外部連携一覧、連絡先表              |
| **注意事項** | 緊急時の連絡権限を明確化             |

---

## 4. フェーズ③ プロセス設計（中核）

### 作業タスク③-1：インシデント対応フロー設計

| 項目       | 内容                 |
| -------- | ------------------ |
| **入力情報** | NIST SP800-61、過去事例 |
| **作業内容** | 標準対応プロセス策定         |
| **方法**   | BPMN / フローチャート     |
| **成果物**  | インシデント対応フロー図       |
| **注意事項** | 判断ポイントを曖昧にしない      |

#### 標準フロー

```
検知 → トリアージ → 初動対応 → 封じ込め
→ 根本原因分析 → 復旧 → 報告 → 再発防止
```

---

### 作業タスク③-2：インシデント分類・重要度定義

| 項目       | 内容              |
| -------- | --------------- |
| **入力情報** | 業務影響度、法令        |
| **作業内容** | 重要度（Severity）定義 |
| **方法**   | 影響×緊急度マトリクス     |
| **成果物**  | インシデント分類表       |
| **注意事項** | 法令報告対象を明確化      |

---

## 5. フェーズ④ 技術基盤設計・導入

### 作業タスク④-1：検知・分析基盤設計

| 項目       | 内容                  |
| -------- | ------------------- |
| **入力情報** | システム構成図             |
| **作業内容** | ログ収集・監視設計           |
| **方法**   | SIEM設計、EDR選定        |
| **成果物**  | 監視設計書               |
| **注意事項** | 「ログはあるが見ていない」状態を避ける |

#### 代表技術

* SIEM（Splunk / Sentinel 等）
* EDR
* クラウド監査ログ（CloudTrail等）

---

### 作業タスク④-2：チケット・証跡管理

| 項目       | 内容            |
| -------- | ------------- |
| **入力情報** | ITSMツール       |
| **作業内容** | インシデント管理設計    |
| **方法**   | チケット連携定義      |
| **成果物**  | インシデント管理ルール   |
| **注意事項** | 監査証跡として耐えられるか |

---

## 6. フェーズ⑤ ルール・ドキュメント整備

### 作業タスク⑤-1：規程・手順書作成

| 成果物例          |
| ------------- |
| CSIRT運用規程     |
| インシデント対応手順書   |
| 報告・エスカレーション基準 |
| 証拠保全手順        |

#### 注意事項

* **法務レビュー必須**
* 実運用に耐えない「棚置き規程」を作らない

---

## 7. フェーズ⑥ 教育・訓練

### 作業タスク⑥-1：訓練計画策定

| 項目       | 内容         |
| -------- | ---------- |
| **入力情報** | 想定シナリオ     |
| **作業内容** | 演習設計       |
| **方法**   | Tabletop演習 |
| **成果物**  | 訓練計画書・評価表  |
| **注意事項** | 年1回以上必須    |

---

## 8. フェーズ⑦ 本番運用・改善

### 作業タスク⑦-1：KPI・改善活動

| 項目       | 内容       |
| -------- | -------- |
| **入力情報** | 対応実績     |
| **作業内容** | KPI分析・改善 |
| **方法**   | 定例レビュー   |
| **成果物**  | 改善報告書    |
| **注意事項** | 形骸化防止    |

---

## 9. CSIRT構築の典型的失敗

❌ 体制だけ作って訓練しない<br>
❌ 技術ツール導入が目的化<br>
❌ 法務・広報不在<br>
❌ 判断基準が属人化<br>

---

# ◆ AWS向けCSIRT構築における具体的作業

以下では、**AWS環境に特化したCSIRT設計例**を、
**「実案件でそのまま設計書に落とせる粒度」**で整理します。
（※あなたが過去に **AWS移行＋Terraform＋監査ログ設計**を経験されている前提で、
**監査・運用・面接説明にも耐える構成**にしています）

---

## 1. AWS向けCSIRT 全体アーキテクチャ（論理）

```
[ AWSアカウント群（Prod / Stg / Dev） ]
        |
        | 監査ログ / セキュリティイベント
        v
[ Security Log Account ]
        |
        | 集約・分析
        v
[ SIEM / SOAR ]
        |
        | チケット / 通知
        v
[ CSIRT運用 ]
   ├─ 初動対応
   ├─ 技術分析
   ├─ 法務・広報連携
```

---

## 2. フェーズ① AWS向けCSIRT基本方針・スコープ

### 2-1. 対象スコープ定義（AWS特有）

| 項目     | 定義例                              |
| ------ | -------------------------------- |
| 対象環境   | AWS Organizations配下 全アカウント       |
| 対象サービス | EC2 / ECS / EKS / RDS / S3 / IAM |
| 対象事象   | 不正API操作、権限昇格、情報漏えい、マルウェア         |
| 非対象    | アプリバグ、性能劣化                       |

---

## 3. フェーズ② 体制設計（AWS特化）

### 3-1. AWS CSIRT役割分担

| 役割       | AWS観点の責務                   |
| -------- | -------------------------- |
| CSIRT責任者 | 経営・法務報告、AWS契約窓口            |
| クラウド管理者  | IAM制御、アカウント隔離              |
| セキュリティ担当 | GuardDuty / Security Hub分析 |
| SRE      | サービス継続・復旧                  |
| 法務・広報    | 個情法・顧客通知判断                 |

---

## 4. フェーズ③ AWSインシデント対応フロー

### 4-1. AWS向け標準フロー（具体）

```
① 検知
   - GuardDuty High / Critical
   - CloudTrail異常API
   - Security Hub Findings

② トリアージ
   - 影響アカウント
   - IAMユーザー / ロール
   - データ流出有無

③ 初動対応（自動 or 手動）
   - IAM無効化
   - セキュリティグループ遮断
   - EC2隔離（Forensic用）

④ 封じ込め
   - アカウント制限
   - KMSキー無効化

⑤ 原因分析
   - CloudTrail分析
   - VPC Flow Logs確認

⑥ 復旧
   - IAM再発行
   - インフラ再構築（IaC）

⑦ 報告・再発防止
```

---

## 5. フェーズ④ AWS技術基盤設計（中核）

### 5-1. ログ・検知基盤（必須）

#### ① CloudTrail（全アカウント）

| 設計項目 | 内容                   |
| ---- | -------------------- |
| 設定   | Organization Trail   |
| 保存先  | Security Log Account |
| 保管   | S3 + Object Lock     |
| 目的   | API操作の証跡             |

---

#### ② GuardDuty

| 項目 | 内容          |
| -- | ----------- |
| 対象 | 全リージョン      |
| 検知 | 不正通信、権限悪用   |
| 連携 | EventBridge |

---

#### ③ Security Hub

| 項目 | 内容                 |
| -- | ------------------ |
| 機能 | Findings集約         |
| 標準 | CIS / Foundational |
| 用途 | CSIRTダッシュボード       |

---

### 5-2. インシデント自動化（SOAR）

#### 自動対応例

| トリガ   | 自動処理                |
| ----- | ------------------- |
| IAM侵害 | ユーザー無効化             |
| EC2侵害 | 隔離SG付与              |
| S3公開  | Block Public Access |

**技術**

* EventBridge
* Lambda
* Step Functions

---

## 6. フェーズ⑤ 証拠保全・フォレンジック設計

### 6-1. AWSフォレンジック標準

| 対象  | 方法             |
| --- | -------------- |
| EC2 | スナップショット取得     |
| EBS | Read Onlyコピー   |
| ログ  | S3 Object Lock |
| IAM | CloudTrail保全   |

⚠ **注意**

* 証拠取得後にのみ再起動
* タイムスタンプ保持

---

## 7. フェーズ⑥ AWS向けドキュメント成果物

| 成果物             | 内容        |
| --------------- | --------- |
| AWS-CSIRT運用規程   | クラウド特化ルール |
| インシデント対応Runbook | サービス別     |
| IAM緊急対応手順       | 手順書       |
| 自動対応設計書         | Lambda仕様  |

---

## 8. フェーズ⑦ KPI・運用改善（AWS）

| KPI   | 指標             |
| ----- | -------------- |
| MTTD  | GuardDuty検知〜確認 |
| MTTR  | 対応完了まで         |
| 自動対応率 | SOAR比率         |
| 再発率   | 同種再発件数         |

---

## 9. AWS向けCSIRT設計の注意点（重要）

❌ CloudTrailが部分的<br>
❌ 監査ログと運用ログ混在<br>
❌ IaC未適用（手作業復旧）<br>
❌ ルートユーザー保護不十分

---


