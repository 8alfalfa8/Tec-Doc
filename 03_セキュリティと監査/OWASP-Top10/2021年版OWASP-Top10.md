◆ # **2021版 OWASP Top 10**
2021年のOWASP Top 10は、Webアプリケーションにおける最も重大なセキュリティリスクをランキング形式でまとめた国際的な業界標準です。
2017年版から3つの新カテゴリが追加され、既存のカテゴリも名称変更や統合が行われました。

以下に各カテゴリの概要と、具体的な診断方法および活用できるツールを詳しく説明します。

### **A01:2021 - アクセス制御の不備**
*   **概要**: ユーザーが本来の権限を超えて、他のユーザーのデータ閲覧や機能実行を許してしまう脆弱性です。例えば、URLパラメータを変更するだけで他ユーザーの情報にアクセスできてしまうケースなどが該当します。2021年版では最も深刻なリスクとして1位にランクインしました。
*   **診断方法 & ツール**:
    *   **手動診断**: 認証済みユーザーでURLやAPIのパラメータ（IDなど）を変更し、権限外の情報にアクセスできないか確認します。また、一般ユーザーで管理者用URLに直接アクセスするテストも有効です。
    *   **ツール**: **OWASP ZAP**などの自動化ツールでクロールし、アクセス可能な全URLを洗い出した上で、権限のないページへのアクセス試行を補助できます。また、**Jtest**のような静的解析ツールで、コード上の認可ロジックの欠落を検出できます。

### **A02:2021 - 暗号化の失敗**
*   **概要**: 機密データ（パスワード、クレジットカード情報等）が適切に保護されていない状態を指します。2017年版の「A3:機微な情報の露出」から、より根本的な原因である「暗号化の失敗」に名称が変更されました。古い暗号化アルゴリズムの使用や、デフォルトの弱い鍵の使用などが該当します。
*   **診断方法 & ツール**:
    *   **手動診断**: ブラウザの開発者ツールでネットワーク通信を確認し、HTTPSが使われていないページや、脆弱なプロトコル（SSL等）が許容されていないかを検証します。また、データベースに保存されているパスワードが暗号化（ソルト付きハッシュ）されているかも確認します。
    *   **ツール**: **Nmap**や**testssl.sh**などのツールで、サーバーが脆弱な暗号スイートやプロトコルをサポートしていないかスキャンできます。

### **A03:2021 - インジェクション**
*   **概要**: アプリケーションが信頼できないデータをコマンドやクエリの一部として解釈してしまうことで発生します。代表的なものにSQLインジェクション、OSコマンドインジェクションがあります。2021年版では、クロスサイトスクリプティング（XSS）もこのカテゴリに統合されました。
*   **診断方法 & ツール**:
    *   **手動診断**: 入力フォームやURLパラメータに特殊文字（`'`、`"`、`;`など）やSQL文（`OR 1=1`など）を送信し、エラー動作や想定外の画面遷移が発生しないか確認します。
    *   **ツール**: **OWASP ZAP**のアクティブスキャン機能を使用すると、自動的にインジェクション系の脆弱性を検出できます。また、**Jtest**のような静的解析ツールで、ソースコード上の危険なAPI使用箇所を特定できます。

### **A04:2021 - 安全が確認されない不安な設計**
*   **概要**: 2021年に新設されたカテゴリで、実装段階ではなく設計上の欠陥に焦点を当てています。例えば、「パスワードの変更時に現在のパスワードを確認しない」といった設計は、後から実装をどんなに頑張っても修正できません。
*   **診断方法 & ツール**:
    *   **手動診断**: **脅威モデリング**を実施し、アプリケーションの設計図に対して「どのような攻撃が可能か」を洗い出します。設計書や画面遷移図をレビューし、セキュリティ要件が漏れなく盛り込まれているかを確認します。
    *   **ツール**: 特定のツールで完全に自動化することは困難です。ただし、**OWASP Threat Dragon**などの脅威モデリングツールを使用すると、設計段階でのリスク分析を効率化できます。

### **A05:2021 - セキュリティの設定ミス**
*   **概要**: アプリケーションスタックのどこかで、不要な機能が有効になっていたり、デフォルトアカウントがそのままだったり、エラーメッセージに機密情報が表示されたりする状態です。2017年版の「A6:不適切なセキュリティ設定」から名称が変更され、XML外部エンティティ参照（XXE）もこのカテゴリに統合されました。
*   **診断方法 & ツール**:
    *   **手動診断**: サーバーやフレームワークの設定ファイルをレビューし、不要な機能（デバッグモード、ディレクトリリスティング等）が無効になっているか確認します。デフォルトのパスワードが使用されていないかもチェックします。
    *   **ツール**: **OWASP ZAP**は、サーバー情報の開示など設定ミスに関連するアラートを検出できます。また、**Jtest**の静的解析でコード上の設定不備を指摘することも可能です。

### **A06:2021 - 脆弱で古くなったコンポーネント**
*   **概要**: アプリケーションで使用しているライブラリやフレームワークなどのコンポーネントに、既知の脆弱性が存在する状態です。2017年版の「A9:既知の脆弱性のあるコンポーネントの使用」から名称が変更され、順位を上げました。
*   **診断方法 & ツール**:
    *   **手動診断**: 使用しているライブラリとそのバージョンをリストアップし、**National Vulnerability Database (NVD)** などで既知の脆弱性（CVE）が公開されていないかを検索します。
    *   **ツール**: **OWASP Dependency-Check**や**Snyk**などのソフトウェア構成分析（SCA）ツールを使用すると、プロジェクトの依存関係を自動的にスキャンし、既知の脆弱性を含むコンポーネントを特定できます。

### **A07:2021 - 識別と認証の失敗**
*   **概要**: ユーザーの身元確認（識別）とログイン（認証）に関する機能の不備を指します。2017年版の「A2:認証の不備」から名称が変更されました。具体例としては、ブルートフォース攻撃を許す、弱いパスワードを許容する、セッションIDがURLに露出するなどがあります。
*   **診断方法 & ツール**:
    *   **手動診断**: ログイン機能に対し、パスワードリスト攻撃やブルートフォース攻撃をシミュレーションし、ロックアウトや多要素認証などの対策が施されているか確認します。ログアウト後にセッションが適切に無効化されるかも検証します。
    *   **ツール**: **Burp Suite**や**OWASP ZAP**のイントルーダー機能を使い、ログイン試行の自動化テストを実施できます。

### **A08:2021 - ソフトウェアとデータの整合性の不具合**
*   **概要**: 2021年に新設されたカテゴリで、ソフトウェアのアップデートや重要なデータが、改ざんされていないかという整合性の検証を欠いている状態を指します。例えば、署名確認なしで外部からプラグインを読み込んだり、信頼できないリポジトリからライブラリを取得したりするケースが該当します。2017年版の「A8:安全でないデシリアライゼーション」もこのカテゴリに統合されました。
*   **診断方法 & ツール**:
    *   **手動診断**: CI/CDパイプラインの設定をレビューし、サードパーティ製コードの取得時に署名検証や改ざんチェックが行われているか確認します。アプリケーションが外部のデータやプラグインを信頼している箇所を洗い出します。
    *   **ツール**: **Jtest**などの静的解析ツールで、整合性検証なしにコードを読み込む処理を検出できます。

### **A09:2021 - セキュリティログとモニタリングの失敗**
*   **概要**: セキュリティ上重要なイベント（ログイン成功/失敗、エラー等）の記録が不十分で、攻撃の早期発見や事後調査が困難になる状態を指します。2017年版の「A10:不十分なロギングとモニタリング」から名称が変更されました。
*   **診断方法 & ツール**:
    *   **手動診断**: 実際に攻撃をシミュレーションし、ログイン失敗の連続や特権操作などの重要なイベントが、適切な詳細さでログに記録されるか確認します。また、そのログが監視・通知される仕組みになっているかも検証します。
    *   **ツール**: **Splunk**や**ELK Stack**などのログ管理ツールを導入し、ログの一元管理とリアルタイムなアラート設定を行います。診断段階では、アプリケーションのログ出力設定をコードレビューや設定ファイルの確認で検証します。

### **A10:2021 - サーバーサイドリクエストフォージェリ(SSRF)**
*   **概要**: 2021年に新設されたカテゴリです。攻撃者がサーバーを踏み台にして、内部ネットワーク上のサーバーに不正なリクエストを送信させる攻撃です。これにより、ファイアウォール内部のシステムが攻撃されるリスクがあります。
*   **診断方法 & ツール**:
    *   **手動診断**: URLを指定する機能（画像のアップロード、Webページのプレビュー等）に対して、`localhost`や`127.0.0.1`、内部プライベートIPアドレスを指定したリクエストを送信し、その応答が返ってくるかどうかを確認します。
    *   **ツール**: **OWASP ZAP**などのツールで、特定のパラメータに対してSSRFのテストパターンを送信するように設定することで、ある程度の自動化が可能です。

これらの診断方法を組み合わせることで、OWASP Top 10 2021で挙げられているリスクを効果的に特定し、対策を進めることができます。

---

## まとめ

| **カテゴリ (A01〜A10)** | **概要** | **診断方法** | **主なツール** |
| :--- | :--- | :--- | :--- |
| **A01:2021 - アクセス制御の不備** | ユーザーが本来の権限を超えて、他のユーザーのデータ閲覧や機能実行を許してしまう脆弱性。 | ・URLやAPIのパラメータ（ID等）を変更し、権限外の情報にアクセスできるか確認。<br>・一般ユーザーで管理者用URLに直接アクセスしてみる。 | ・**OWASP ZAP**（自動クロールとアクセス試行の補助）<br>・**Jtest**（静的解析で認可ロジックの欠落を検出） |
| **A02:2021 - 暗号化の失敗** | 機密データが適切に保護されていない状態。古い暗号化アルゴリズムの使用、デフォルトの弱い鍵の使用など。 | ・ブラウザの開発者ツールでHTTPS未使用ページや脆弱なプロトコル（SSL等）が許容されていないか確認。<br>・DB保存データ（パスワード等）が暗号化（ソルト付きハッシュ）されているか確認。 | ・**Nmap**<br>・**testssl.sh**（サーバーの脆弱な暗号スイートやプロトコルのスキャン） |
| **A03:2021 - インジェクション** | 信頼できないデータがコマンドやクエリの一部として解釈されることで発生する脆弱性。SQLインジェクション、XSS等。 | ・入力フォームやURLパラメータに特殊文字（`'`、`"`等）やSQL文（`OR 1=1`等）を送信し、エラー動作等を確認。 | ・**OWASP ZAP**（アクティブスキャンでの自動検出）<br>・**Jtest**（静的解析で危険なAPI使用箇所を特定） |
| **A04:2021 - 安全が確認されない不安な設計** | 実装段階ではなく、設計上の欠陥に焦点を当てたカテゴリ。セキュリティ要件の欠落など。 | ・**脅威モデリング**を実施し、設計図に対して攻撃可能性を洗い出す。<br>・設計書や画面遷移図をレビューし、セキュリティ要件の漏れを確認。 | ・**OWASP Threat Dragon**（脅威モデリングツール）<br>※完全な自動化は困難 |
| **A05:2021 - セキュリティの設定ミス** | 不要な機能が有効、デフォルトアカウントの放置、エラーメッセージによる情報漏洩など。 | ・サーバーやフレームワークの設定ファイルをレビューし、不要な機能（デバッグモード等）が無効か確認。<br>・デフォルトパスワードが使用されていないか確認。 | ・**OWASP ZAP**（サーバー情報開示等の設定ミス検出）<br>・**Jtest**（コード上の設定不備の指摘） |
| **A06:2021 - 脆弱で古くなったコンポーネント** | 使用しているライブラリやフレームワークに、既知の脆弱性（CVE）が存在する状態。 | ・使用中のライブラリとバージョンをリストアップし、NVD等で既知の脆弱性を検索。 | ・**OWASP Dependency-Check**<br>・**Snyk**（SCAツールによる依存関係の脆弱性スキャン） |
| **A07:2021 - 識別と認証の失敗** | ユーザー識別・認証機能の不備。ブルートフォース許容、弱いパスワード許容、セッションIDの露出など。 | ・ログイン機能へのパスワードリスト攻撃やブルートフォース攻撃をシミュレーションし、対策の有無を確認。<br>・ログアウト後のセッション無効化を検証。 | ・**Burp Suite**<br>・**OWASP ZAP**（イントルーダー機能でのログイン試行自動化） |
| **A08:2021 - ソフトウェアとデータの整合性の不具合** | ソフトウェア更新や重要データの整合性検証を欠いている状態。署名確認なしの外部プラグイン読込、安全でないデシリアライゼーション等。 | ・CI/CDパイプラインの設定をレビューし、署名検証等の実施を確認。<br>・アプリケーションが外部データを信頼している箇所を洗い出し。 | ・**Jtest**（静的解析で整合性検証なしのコード読込処理を検出） |
| **A09:2021 - セキュリティログとモニタリングの失敗** | セキュリティ上重要なイベントの記録が不十分で、攻撃の早期発見や事後調査が困難になる状態。 | ・攻撃をシミュレーションし、ログイン失敗等の重要なイベントが適切に記録されるか確認。<br>・ログの監視・通知仕組みの有無を検証。 | ・**Splunk**<br>・**ELK Stack**（ログ管理・一元管理、アラート設定）<br>※診断時はコードレビューや設定ファイル確認 |
| **A10:2021 - サーバーサイドリクエストフォージェリ(SSRF)** | 攻撃者がサーバーを踏み台に、内部ネットワークへ不正なリクエストを送信する攻撃。 | ・URL指定機能（画像アップロード等）に`localhost`や内部IPアドレスを指定し、応答を確認。 | ・**OWASP ZAP**（特定パラメータへのSSRFテストパターン送信による自動化補助） |

---

