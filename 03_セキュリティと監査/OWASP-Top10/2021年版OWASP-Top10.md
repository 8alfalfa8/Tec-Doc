# **◆ 2021年版 OWASP Top 10**
2021年のOWASP Top 10は、Webアプリケーションにおける最も重大なセキュリティリスクをランキング形式でまとめた国際的な業界標準です。
2017年版から3つの新カテゴリが追加され、既存のカテゴリも名称変更や統合が行われました。

以下に各カテゴリの概要と、具体的な診断方法および活用できるツールを詳しく説明します。

### **A01:2021 - アクセス制御の不備**
*   **概要**: ユーザーが本来の権限を超えて、他のユーザーのデータ閲覧や機能実行を許してしまう脆弱性です。例えば、URLパラメータを変更するだけで他ユーザーの情報にアクセスできてしまうケースなどが該当します。2021年版では最も深刻なリスクとして1位にランクインしました。
*   **診断方法 & ツール**:
    *   **手動診断**: 認証済みユーザーでURLやAPIのパラメータ（IDなど）を変更し、権限外の情報にアクセスできないか確認します。また、一般ユーザーで管理者用URLに直接アクセスするテストも有効です。
    *   **ツール**: **OWASP ZAP**などの自動化ツールでクロールし、アクセス可能な全URLを洗い出した上で、権限のないページへのアクセス試行を補助できます。また、**Jtest**のような静的解析ツールで、コード上の認可ロジックの欠落を検出できます。

### **A02:2021 - 暗号化の失敗**
*   **概要**: 機密データ（パスワード、クレジットカード情報等）が適切に保護されていない状態を指します。2017年版の「A3:機微な情報の露出」から、より根本的な原因である「暗号化の失敗」に名称が変更されました。古い暗号化アルゴリズムの使用や、デフォルトの弱い鍵の使用などが該当します。
*   **診断方法 & ツール**:
    *   **手動診断**: ブラウザの開発者ツールでネットワーク通信を確認し、HTTPSが使われていないページや、脆弱なプロトコル（SSL等）が許容されていないかを検証します。また、データベースに保存されているパスワードが暗号化（ソルト付きハッシュ）されているかも確認します。
    *   **ツール**: **Nmap**や**testssl.sh**などのツールで、サーバーが脆弱な暗号スイートやプロトコルをサポートしていないかスキャンできます。

### **A03:2021 - インジェクション**
*   **概要**: アプリケーションが信頼できないデータをコマンドやクエリの一部として解釈してしまうことで発生します。代表的なものにSQLインジェクション、OSコマンドインジェクションがあります。2021年版では、クロスサイトスクリプティング（XSS）もこのカテゴリに統合されました。
*   **診断方法 & ツール**:
    *   **手動診断**: 入力フォームやURLパラメータに特殊文字（`'`、`"`、`;`など）やSQL文（`OR 1=1`など）を送信し、エラー動作や想定外の画面遷移が発生しないか確認します。
    *   **ツール**: **OWASP ZAP**のアクティブスキャン機能を使用すると、自動的にインジェクション系の脆弱性を検出できます。また、**Jtest**のような静的解析ツールで、ソースコード上の危険なAPI使用箇所を特定できます。

### **A04:2021 - 安全が確認されない不安な設計**
*   **概要**: 2021年に新設されたカテゴリで、実装段階ではなく設計上の欠陥に焦点を当てています。例えば、「パスワードの変更時に現在のパスワードを確認しない」といった設計は、後から実装をどんなに頑張っても修正できません。
*   **診断方法 & ツール**:
    *   **手動診断**: **脅威モデリング**を実施し、アプリケーションの設計図に対して「どのような攻撃が可能か」を洗い出します。設計書や画面遷移図をレビューし、セキュリティ要件が漏れなく盛り込まれているかを確認します。
    *   **ツール**: 特定のツールで完全に自動化することは困難です。ただし、**OWASP Threat Dragon**などの脅威モデリングツールを使用すると、設計段階でのリスク分析を効率化できます。

### **A05:2021 - セキュリティの設定ミス**
*   **概要**: アプリケーションスタックのどこかで、不要な機能が有効になっていたり、デフォルトアカウントがそのままだったり、エラーメッセージに機密情報が表示されたりする状態です。2017年版の「A6:不適切なセキュリティ設定」から名称が変更され、XML外部エンティティ参照（XXE）もこのカテゴリに統合されました。
*   **診断方法 & ツール**:
    *   **手動診断**: サーバーやフレームワークの設定ファイルをレビューし、不要な機能（デバッグモード、ディレクトリリスティング等）が無効になっているか確認します。デフォルトのパスワードが使用されていないかもチェックします。
    *   **ツール**: **OWASP ZAP**は、サーバー情報の開示など設定ミスに関連するアラートを検出できます。また、**Jtest**の静的解析でコード上の設定不備を指摘することも可能です。

### **A06:2021 - 脆弱で古くなったコンポーネント**
*   **概要**: アプリケーションで使用しているライブラリやフレームワークなどのコンポーネントに、既知の脆弱性が存在する状態です。2017年版の「A9:既知の脆弱性のあるコンポーネントの使用」から名称が変更され、順位を上げました。
*   **診断方法 & ツール**:
    *   **手動診断**: 使用しているライブラリとそのバージョンをリストアップし、**National Vulnerability Database (NVD)** などで既知の脆弱性（CVE）が公開されていないかを検索します。
    *   **ツール**: **OWASP Dependency-Check**や**Snyk**などのソフトウェア構成分析（SCA）ツールを使用すると、プロジェクトの依存関係を自動的にスキャンし、既知の脆弱性を含むコンポーネントを特定できます。

### **A07:2021 - 識別と認証の失敗**
*   **概要**: ユーザーの身元確認（識別）とログイン（認証）に関する機能の不備を指します。2017年版の「A2:認証の不備」から名称が変更されました。具体例としては、ブルートフォース攻撃を許す、弱いパスワードを許容する、セッションIDがURLに露出するなどがあります。
*   **診断方法 & ツール**:
    *   **手動診断**: ログイン機能に対し、パスワードリスト攻撃やブルートフォース攻撃をシミュレーションし、ロックアウトや多要素認証などの対策が施されているか確認します。ログアウト後にセッションが適切に無効化されるかも検証します。
    *   **ツール**: **Burp Suite**や**OWASP ZAP**のイントルーダー機能を使い、ログイン試行の自動化テストを実施できます。

### **A08:2021 - ソフトウェアとデータの整合性の不具合**
*   **概要**: 2021年に新設されたカテゴリで、ソフトウェアのアップデートや重要なデータが、改ざんされていないかという整合性の検証を欠いている状態を指します。例えば、署名確認なしで外部からプラグインを読み込んだり、信頼できないリポジトリからライブラリを取得したりするケースが該当します。2017年版の「A8:安全でないデシリアライゼーション」もこのカテゴリに統合されました。
*   **診断方法 & ツール**:
    *   **手動診断**: CI/CDパイプラインの設定をレビューし、サードパーティ製コードの取得時に署名検証や改ざんチェックが行われているか確認します。アプリケーションが外部のデータやプラグインを信頼している箇所を洗い出します。
    *   **ツール**: **Jtest**などの静的解析ツールで、整合性検証なしにコードを読み込む処理を検出できます。

### **A09:2021 - セキュリティログとモニタリングの失敗**
*   **概要**: セキュリティ上重要なイベント（ログイン成功/失敗、エラー等）の記録が不十分で、攻撃の早期発見や事後調査が困難になる状態を指します。2017年版の「A10:不十分なロギングとモニタリング」から名称が変更されました。
*   **診断方法 & ツール**:
    *   **手動診断**: 実際に攻撃をシミュレーションし、ログイン失敗の連続や特権操作などの重要なイベントが、適切な詳細さでログに記録されるか確認します。また、そのログが監視・通知される仕組みになっているかも検証します。
    *   **ツール**: **Splunk**や**ELK Stack**などのログ管理ツールを導入し、ログの一元管理とリアルタイムなアラート設定を行います。診断段階では、アプリケーションのログ出力設定をコードレビューや設定ファイルの確認で検証します。

### **A10:2021 - サーバーサイドリクエストフォージェリ(SSRF)**
*   **概要**: 2021年に新設されたカテゴリです。攻撃者がサーバーを踏み台にして、内部ネットワーク上のサーバーに不正なリクエストを送信させる攻撃です。これにより、ファイアウォール内部のシステムが攻撃されるリスクがあります。
*   **診断方法 & ツール**:
    *   **手動診断**: URLを指定する機能（画像のアップロード、Webページのプレビュー等）に対して、`localhost`や`127.0.0.1`、内部プライベートIPアドレスを指定したリクエストを送信し、その応答が返ってくるかどうかを確認します。
    *   **ツール**: **OWASP ZAP**などのツールで、特定のパラメータに対してSSRFのテストパターンを送信するように設定することで、ある程度の自動化が可能です。

これらの診断方法を組み合わせることで、OWASP Top 10 2021で挙げられているリスクを効果的に特定し、対策を進めることができます。

---

## まとめ

| **カテゴリ (A01〜A10)** | **概要** | **診断方法** | **主なツール** |
| :--- | :--- | :--- | :--- |
| **A01:2021 - アクセス制御の不備** | ユーザーが本来の権限を超えて、他のユーザーのデータ閲覧や機能実行を許してしまう脆弱性。 | ・URLやAPIのパラメータ（ID等）を変更し、権限外の情報にアクセスできるか確認。<br>・一般ユーザーで管理者用URLに直接アクセスしてみる。 | ・**OWASP ZAP**（自動クロールとアクセス試行の補助）<br>・**Jtest**（静的解析で認可ロジックの欠落を検出） |
| **A02:2021 - 暗号化の失敗** | 機密データが適切に保護されていない状態。古い暗号化アルゴリズムの使用、デフォルトの弱い鍵の使用など。 | ・ブラウザの開発者ツールでHTTPS未使用ページや脆弱なプロトコル（SSL等）が許容されていないか確認。<br>・DB保存データ（パスワード等）が暗号化（ソルト付きハッシュ）されているか確認。 | ・**Nmap**<br>・**testssl.sh**（サーバーの脆弱な暗号スイートやプロトコルのスキャン） |
| **A03:2021 - インジェクション** | 信頼できないデータがコマンドやクエリの一部として解釈されることで発生する脆弱性。SQLインジェクション、XSS等。 | ・入力フォームやURLパラメータに特殊文字（`'`、`"`等）やSQL文（`OR 1=1`等）を送信し、エラー動作等を確認。 | ・**OWASP ZAP**（アクティブスキャンでの自動検出）<br>・**Jtest**（静的解析で危険なAPI使用箇所を特定） |
| **A04:2021 - 安全が確認されない不安な設計** | 実装段階ではなく、設計上の欠陥に焦点を当てたカテゴリ。セキュリティ要件の欠落など。 | ・**脅威モデリング**を実施し、設計図に対して攻撃可能性を洗い出す。<br>・設計書や画面遷移図をレビューし、セキュリティ要件の漏れを確認。 | ・**OWASP Threat Dragon**（脅威モデリングツール）<br>※完全な自動化は困難 |
| **A05:2021 - セキュリティの設定ミス** | 不要な機能が有効、デフォルトアカウントの放置、エラーメッセージによる情報漏洩など。 | ・サーバーやフレームワークの設定ファイルをレビューし、不要な機能（デバッグモード等）が無効か確認。<br>・デフォルトパスワードが使用されていないか確認。 | ・**OWASP ZAP**（サーバー情報開示等の設定ミス検出）<br>・**Jtest**（コード上の設定不備の指摘） |
| **A06:2021 - 脆弱で古くなったコンポーネント** | 使用しているライブラリやフレームワークに、既知の脆弱性（CVE）が存在する状態。 | ・使用中のライブラリとバージョンをリストアップし、NVD等で既知の脆弱性を検索。 | ・**OWASP Dependency-Check**<br>・**Snyk**（SCAツールによる依存関係の脆弱性スキャン） |
| **A07:2021 - 識別と認証の失敗** | ユーザー識別・認証機能の不備。ブルートフォース許容、弱いパスワード許容、セッションIDの露出など。 | ・ログイン機能へのパスワードリスト攻撃やブルートフォース攻撃をシミュレーションし、対策の有無を確認。<br>・ログアウト後のセッション無効化を検証。 | ・**Burp Suite**<br>・**OWASP ZAP**（イントルーダー機能でのログイン試行自動化） |
| **A08:2021 - ソフトウェアとデータの整合性の不具合** | ソフトウェア更新や重要データの整合性検証を欠いている状態。署名確認なしの外部プラグイン読込、安全でないデシリアライゼーション等。 | ・CI/CDパイプラインの設定をレビューし、署名検証等の実施を確認。<br>・アプリケーションが外部データを信頼している箇所を洗い出し。 | ・**Jtest**（静的解析で整合性検証なしのコード読込処理を検出） |
| **A09:2021 - セキュリティログとモニタリングの失敗** | セキュリティ上重要なイベントの記録が不十分で、攻撃の早期発見や事後調査が困難になる状態。 | ・攻撃をシミュレーションし、ログイン失敗等の重要なイベントが適切に記録されるか確認。<br>・ログの監視・通知仕組みの有無を検証。 | ・**Splunk**<br>・**ELK Stack**（ログ管理・一元管理、アラート設定）<br>※診断時はコードレビューや設定ファイル確認 |
| **A10:2021 - サーバーサイドリクエストフォージェリ(SSRF)** | 攻撃者がサーバーを踏み台に、内部ネットワークへ不正なリクエストを送信する攻撃。 | ・URL指定機能（画像アップロード等）に`localhost`や内部IPアドレスを指定し、応答を確認。 | ・**OWASP ZAP**（特定パラメータへのSSRFテストパターン送信による自動化補助） |

---

## 2021年版OWASP Top 10各カテゴリの詳細な対策方法と、組織における具体的な導入ポイント・ステップ

| **カテゴリ (A01〜A10)** | **より詳細な対策方法** | **組織における具体的な導入ポイント・ステップ** |
| :--- | :--- | :--- |
| **A01:2021 - アクセス制御の不備** | • **デフォルト拒否(Deny by Default)**の原則を実装し、明示的に許可されたリソース以外へのアクセスをブロックする。<br>• アクセス制御は信頼できる**サーバーサイド**で一元的に実行し、クライアントサイドのチェックのみに依存しない。<br>• APIやコントローラへのアクセスに**レート制限**を実装し、自動化ツールによる攻撃の影響を最小化する。<br>• **JWT**などのステートレスなトークンは**有効期間を短く**設定し、OAuth標準に従った失効メカニズムを実装する。<br>• **CORS**の使用を必要最小限に抑え、設定を適切に行う。 | **フェーズ1: 現状分析** <br>1. 現在のアクセス制御ポリシーと実装を棚卸し、特権アカウントや未使用アカウントを特定する。<br>2. **ペネトレーションテスト**を実施し、IDORや権限昇格の脆弱性がないか検証する（自動ツールでは検出困難な場合がある）。<br><br>**フェーズ2: 対策実装** <br>1. **RBAC**モデルを導入し、役割ごとに最小権限の原則を適用する。<br>2. アクセス制御を一元管理する共通コンポーネントを開発・導入する。<br>3. アクセス制御の失敗を**ログ記録**し、管理者にアラートを送信する仕組みを構築する。 |
| **A02:2021 - 暗号化の失敗** | • アプリケーションで処理・保存・転送するデータを**機密性に基づき分類**する（個人情報、認証情報、決済データなど）。<br>• 機密データは**保存時**に強力な暗号化アルゴリズム（AES-256等）で暗号化する。<br>• 転送時には**TLS 1.3**など最新の安全なプロトコルを使用し、**HSTS**を有効にしてHTTPSを強制する。<br>• パスワードは**Argon2**、**bcrypt**、**PBKDF2**などの適応的でソルト付きのハッシュ関数を使用して保存する。<br>• **暗号鍵のライフサイクル管理**を確立し、鍵の生成、保存、ローテーションを安全に行う。 | **フェーズ1: データインベントリ作成** <br>1. アプリケーションが取り扱う全データを洗い出し、機密度に応じて分類する。<br>2. 保存する必要のない機密データは保持しない方針を徹底する。<br><br>**フェーズ2: 暗号化実装** <br>1. 保存データ暗号化の対象を特定し、暗号化方式を決定する。<br>2. 転送時暗号化を適用し、TLS設定を**testssl.sh**等で定期的に検証する。<br>3. パスワード保存方式を最新の安全なハッシュ関数に移行する。<br><br>**フェーズ3: 鍵管理体制構築** <br>1. 鍵管理ポリシーを策定し、HSMや鍵管理サービスを導入する。 |
| **A03:2021 - インジェクション** | • **パラメータ化クエリ**、**プリペアドステートメント**、または安全な**ORM**を使用して、SQLインジェクションを防止する。<br>• ユーザー入力に対する**ホワイトリスト方式のバリデーション**をサーバーサイドで実装する。<br>• 特殊文字が必要なコンテキストでは、インタプリタに応じた適切な**エスケープ処理**を行う。<br>• **LIMIT**句などを使用して、SQLインジェクション発生時の情報漏洩量を制限する。<br>• **SAST**、**DAST**、**IAST**ツールをCI/CDパイプラインに統合し、インジェクション欠陥を早期に発見する。 | **フェーズ1: 開発プロセス改善** <br>1. 全開発者を対象に、パラメータ化クエリなどの安全なコーディング手法のトレーニングを実施する。<br>2. コーディング規約にインジェクション対策を明記する。<br><br>**フェーズ2: ツール導入** <br>1. 既存コードベースに対してSASTツールを実行し、インジェクション脆弱性を洗い出す。<br>2. CI/CDパイプラインにSAST/DASTツールを組み込み、新規コードでの脆弱性混入を防止する。<br><br>**フェーズ3: 入力バリデーション統一** <br>1. アプリケーション全体で共通的に使用できる入力バリデーションライブラリを整備する。 |
| **A04:2021 - 安全が確認されていない不安な設計** | • アプリケーション設計段階で**脅威モデリング**を実施し、潜在的なセキュリティリスクを特定する。<br>• **安全な設計パターン**のライブラリを整備し、新規アプリケーション開発で再利用できるようにする。<br>• ユーザーストーリーにセキュリティ要件を組み込み、各機能の**ユースケース**と**ミスユースケース**を作成する。<br>• アプリケーションの各層（フロントエンドからバックエンドまで）で**妥当性チェック**を実装する。<br>• テナント間の分離を設計レベルで強固に行う。 | **フェーズ1: 人材育成と体制構築** <br>1. アプリケーションセキュリティの専門家を育成・確保し、設計レビューに関与させる。<br>2. **セキュア開発ライフサイクル**を定義し、設計フェーズでのセキュリティチェックポイントを設定する。<br><br>**フェーズ2: 設計プロセス改善** <br>1. 重要な機能（認証、認可、ビジネスロジック等）について、**脅威モデリング**を義務化する。<br>2. 設計レビューでセキュリティ観点のチェックリストを活用する。<br><br>**フェーズ3: テスト自動化** <br>1. 脅威モデルに基づいた**単体テスト**・**統合テスト**を作成し、CI/CDで自動実行する。 |
| **A05:2021 - セキュリティの設定ミス** | • 環境ごとに異なる認証情報を使用した**ハードニングテンプレート**を整備し、自動化されたプロセスで適用する。<br>• 不要な機能、サービス、ポート、サンプルアプリケーション、デフォルトアカウントは**無効化または削除**する。<br>• セキュリティヘッダー（**HSTS**、**CSP**、**X-Frame-Options**等）を適切に設定する。<br>• すべての環境で設定の有効性を**自動検証**する仕組みを導入する。<br>• パッチ管理プロセスを確立し、ソフトウェアを常に最新の状態に保つ。 | **フェーズ1: 設定標準化** <br>1. OS、ミドルウェア、フレームワークごとに**セキュアな設定テンプレート**を作成する。<br>2. 開発・テスト・本番環境で一貫した設定が適用されるよう、**Infrastructure as Code**を導入する。<br><br>**フェーズ2: 自動化ツール導入** <br>1. **CSPM**ツールを導入し、クラウド環境の設定ミスを自動検出する。<br>2. 脆弱性スキャナーを定期的に実行し、設定不備がないか確認する。<br><br>**フェーズ3: 定期的な棚卸し** <br>1. 四半期ごとに不要な機能・サービスの有無をレビューし、削除する。 |
| **A06:2021 - 脆弱で古くなったコンポーネント** | • 使用している全コンポーネントとそのバージョンを網羅した**ソフトウェア部品表**を維持管理する。<br>• コンポーネントとその依存関係を継続的にスキャンし、既知の脆弱性を監視する。<br>• パッチがすぐに適用できない場合は、**仮想パッチ**を適用してリスクを軽減する。<br>• 公式・信頼できるソースからのみコンポーネントを取得する。<br>• 使用していないコンポーネント、レガシーコンポーネント、非推奨機能はアプリケーションから**削除**する。 | **フェーズ1: 可視化** <br>1. **SCAツール**を導入し、アプリケーションが使用する全コンポーネントとその依存関係を自動的に可視化する。<br>2. 初回スキャンを実行し、脆弱性のあるコンポーネントの一覧を作成する。<br><br>**フェーズ2: リスク評価と優先順位付け** <br>1. 検出された脆弱性の深刻度と悪用可能性に基づき、対応優先順位を決定する。<br><br>**フェーズ3: 継続的モニタリング** <br>1. 新たな脆弱性が公開された際にアラートを受け取る仕組みを構築する。<br>2. **パッチ管理プロセス**を確立し、定期的なアップデートを実施する。 |
| **A07:2021 - 識別と認証の失敗** | • **多要素認証**を実装し、パスワードのみの認証からの脱却を図る。<br>• デフォルト認証情報の使用を禁止し、特に管理者権限では強力なパスワードポリシーを適用する。<br>• ログイン試行失敗回数に制限を設け、アカウントロックアウトや遅延を導入する。<br>• ログイン成功時に新しいセッションIDを発行し、セッションIDはURLに含めず暗号化されたチャネルで送信する。<br>• 適切な**セッションタイムアウト**を設定し、ログアウト時にサーバーサイドでセッションを無効化する。 | **フェーズ1: 認証基盤強化** <br>1. 重要システムから順に**MFA**を段階的に導入する。<br>2. パスワードポリシーを強化し、脆弱なパスワードを許可しないようにする。<br><br>**フェーズ2: 認証フロー改善** <br>1. ログイン試行制限機能を実装し、ブルートフォース攻撃を防止する。<br>2. セッション管理の実装をレビューし、安全な方式に改善する。<br><br>**フェーズ3: 監視強化** <br>1. 認証失敗のログを監視し、不審なアクティビティを検知する仕組みを導入する。 |
| **A08:2021 - ソフトウェアとデータの整合性の不具合** | • ソフトウェア更新プログラムやデータの正当性を**電子署名**やハッシュアルゴリズムで検証する。<br>• **CI/CDパイプライン**に強力なアクセス制御を実装し、設定の適切な分離と定期的なセキュリティレビューを行う。<br>• ライブラリや依存関係は信頼できるリポジトリからのみ取得し、リスクの高い環境では**内部リポジトリ**をホストする。<br>• シリアライズ/デシリアライズを行う場合、シリアライズデータの**整合性検証**を実施する。 | **フェーズ1: CI/CDセキュリティ強化** <br>1. CI/CDパイプラインへのアクセス権限を見直し、最小権限の原則を適用する。<br>2. ビルドプロセスで使用するツールやスクリプトの整合性検証を実施する。<br><br>**フェーズ2: サプライチェーン管理** <br>1. 使用するライブラリのソースを信頼できるリポジトリに限定する。<br>2. 重要なライブラリについては、内部リポジトリの構築を検討する。<br><br>**フェーズ3: デシリアライゼーション対策** <br>1. デシリアライズを行う箇所を特定し、データの改ざん検出機能を実装する。 |
| **A09:2021 - セキュリティログとモニタリングの失敗** | • ログイン成功/失敗、アクセス制御失敗、入力検証失敗など、セキュリティ上重要なイベントを**漏れなくログ記録**する。<br>• ログは分析に適した形式で出力し、**定期的なバックアップ**を実施する。<br>• 疑わしいアクティビティを検知するための**しきい値**を設定し、リアルタイムでアラートを通知する仕組みを構築する。<br>• ログデータの改ざんを防止するセキュリティ制御を実装する。<br>• **インシデント対応計画**および復旧計画を策定する。 | **フェーズ1: ロギング基盤構築** <br>1. どのイベントをログ記録すべきか定義する。<br>2. **ログ管理・分析ツール**を導入し、ログを一元管理する。<br><br>**フェーズ2: モニタリング体制構築** <br>1. 重要なイベントに対するアラートしきい値を設定する。<br>2. セキュリティ監視チームを編成し、24/7の監視体制を整備する。<br><br>**フェーズ3: インシデント対応準備** <br>1. **インシデント対応計画**を策定し、定期的に訓練を実施する。 |
| **A10:2021 - サーバーサイドリクエストフォージェリ(SSRF)** | • ユーザー入力に対して厳格な**バリデーション**と**サニタイズ**を実施する。<br>• リモートリソースにアクセスする機能は、可能であれば**分離された環境**で実行する。<br>• **デフォルト拒否のファイアウォールポリシー**を適用し、不要な内部トラフィックをブロックする。<br>• 許可するURLスキーム、ポート、宛先を**ホワイトリスト**で管理する。<br>• クライアントにサーバーからの生の応答を返さないようにする。<br>• 内部ネットワーク間の通信にも**ファイアウォール**によるアクセス制御を適用する。 | **フェーズ1: アーキテクチャ見直し** <br>1. URL指定機能を持つアプリケーションを特定する。<br>2. ネットワークセグメンテーションを見直し、アプリケーションサーバーから内部リソースへの不要な経路を遮断する。<br><br>**フェーズ2: 入力検証強化** <br>1. URLスキーム、ホスト名、ポート番号に対する**ホワイトリスト検証**を実装する。<br><br>**フェーズ3: レスポンス処理改善** <br>1. サーバーからの応答を検証し、機密情報が含まれていないか確認する処理を追加する。<br>2. エラーメッセージで内部情報が漏洩しないよう対策する。 |

これらの対策を組織全体で体系的に導入することで、OWASP Top 10 2021のリスクを効果的に低減できます。特に重要なのは、**シフトレフト**（開発初期段階でのセキュリティ対策）と**継続的改善**の考え方を組織文化として根付かせることです。

---
