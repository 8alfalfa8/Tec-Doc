# **◆ 2025年版 OWASP Top 10**

2025年のOWASP Top 10は、2021年版から大きなアップデートが行われ、現代のアプリケーションセキュリティの脅威をより正確に反映した内容となっています。

まず、2021年版から2025年版への主要な変更点を表にまとめます。

| **2025年順位** | **カテゴリ名** | **2021年順位との比較・備考** |
| :--- | :--- | :--- |
| **A01** | アクセス制御の不備 | **1位から変わらず**。SSRF（A10）を統合。 |
| **A02** | 安全構成のミス | **5位から上昇**。クラウド環境の増加を反映。 |
| **A03** | ソフトウェアサプライチェーンの破綻 | **新設カテゴリ**（旧: 脆弱で古くなったコンポーネントを拡張）。 |
| **A04** | 暗号化の失敗 | **2位から下降**。 |
| **A05** | インジェクション | **3位から下降**。 |
| **A06** | 安全が確認されていない不安な設計 | **4位から下降**。 |
| **A07** | 識別と認証の失敗 | **7位から変わらず**。 |
| **A08** | ソフトウェアとデータの整合性の不具合 | **8位から変わらず**。 |
| **A09** | セキュリティログとモニタリングの失敗 | **9位から変わらず**（名称を「ロギングとアラートの失敗」に変更）。 |
| **A10** | 例外条件の不適切な処理 | **新設カテゴリ**。エラー処理の失敗などを包含。 |

以下が、2025年のOWASP Top 10の各カテゴリと、その概要、診断方法、ツールの情報です。

### **A01:2025 - アクセス制御の不備 (Broken Access Control)**

*   **概要**: ユーザーが本来の権限を超えてデータや機能にアクセスできてしまう脆弱性です。2021年に引き続き最も深刻なリスクとなっており、今回のアップデートで**SSRF（サーバーサイドリクエストフォージェリ）**がこのカテゴリに統合されました。攻撃者は、IDの連番を変更したり、URLに直接アクセスしたりして、情報を不正に閲覧・改ざんしようとします。
*   **診断方法**: 認証済みの状態で、URLパラメータやAPIのリクエストを変更し、他ユーザーの情報や権限が必要な機能にアクセスできるか手動で確認します。また、内部ネットワークへの入り口となるSSRFの観点から、URL指定機能などに`localhost`や内部IPアドレスを指定したリクエストを送信し、応答の有無をテストします。
*   **ツール**: **Burp Suite**や**OWASP ZAP**などのDASTツールを使い、リクエストの改ざんや認可のバイパステストを自動化・効率化できます。特に、スキャン機能で広範なURLを探索し、アクセス制御の脆弱性がないかチェックします。

### **A02:2025 - 安全構成のミス (Security Misconfiguration)**

*   **概要**: クラウド環境やコンテナ技術の普及に伴い、重要性が増しているカテゴリです。デフォルトの認証情報がそのまま使われていたり、不要な機能やポートが開放されていたり、エラーメッセージに詳細な情報が表示されてしまうなどの設定不備を指します。
*   **診断方法**: サーバーやフレームワーク、クラウドサービスの設定ファイルを徹底的にレビューします。デフォルトアカウントの有無、デバッグモードの無効化、不要なHTTPメソッドの許可、ディレクトリリスティングの有効/無効などを手動で確認します。
*   **ツール**: **Nessus**や**Nmap**などの構成監査・脆弱性スキャンツールを使用すると、既知の設定ミスを自動的に検出できます。クラウド環境専用の**Scout Suite**のようなツールは、マルチクラウド環境のセキュリティ posture を評価するのに役立ちます。

### **A03:2025 - ソフトウェアサプライチェーンの破綻 (Software Supply Chain Failures)**

*   **概要**: 2025年版で新設され、第3位にランクインしたカテゴリです。これは、2021年版の「脆弱で古くなったコンポーネント」を拡張し、アプリケーションが依存するライブラリだけでなく、ビルドパイプラインや配布インフラなど、ソフトウェアの開発・供給プロセス全体のリスクを含みます。依存関係混乱攻撃や悪意のあるパッケージの混入などが該当します。
*   **診断方法**: **ソフトウェア部品表 (SBOM)** を作成・活用し、使用しているすべてのオープンソースコンポーネントやサードパーティ製ライブラリを可視化します。各コンポーネントに既知の脆弱性（CVE）がないか、脆弱性データベースで継続的に照合します。
*   **ツール**: **Snyk**、**OWASP Dependency-Check**などのソフトウェア構成分析（SCA）ツールが必須です。これらはプロジェクトの依存関係を自動スキャンし、脆弱性のあるコンポーネントやライセンス違反を検出します。また、**Waratek RASP**のようなランタイム保護ツールは、発見された脆弱性に対する仮想パッチを即座に適用し、本番環境を保護します。

### **A04:2025 - 暗号化の失敗 (Cryptographic Failures)**

*   **概要**: 機密性の高いデータが適切に保護されていない状態を指します（2021年のA02から順位は下降）。古くて脆弱な暗号アルゴリズム（SHA-1、MD5など）の使用、デフォルトの鍵や短い鍵の利用、HTTPSの未適用などが該当します。
*   **診断方法**: ネットワーク通信がTLSなどで適切に暗号化されているか、ブラウザの開発者ツールやプロキシツールで確認します。また、データベースに保存されているパスワードやクレジットカード情報が、ソルト付きハッシュや強力な暗号化方式で保護されているか、コードや設定をレビューします。
*   **ツール**: **testssl.sh**や**SSLyze**は、サーバーのSSL/TLS設定をスキャンし、脆弱なプロトコルや暗号スイートが有効になっていないかを検出します。静的解析ツール（SAST）の**Checkmarx**などは、ソースコード中の弱い暗号化処理を特定できます。

### **A05:2025 - インジェクション (Injection)**

*   **概要**: SQLインジェクションやクロスサイトスクリプティング（XSS）など、信頼できないデータがコマンドやクエリの一部として解釈されることで発生する脆弱性です（2021年のA03から順位は下降）。
*   **診断方法**: すべての入力フォームやURLパラメータに対して、特殊文字やSQL文、スクリプトタグなどを送信し、エラーメッセージや動作の変化を確認します。自動化ツールを利用することで、網羅的なテストが可能です。
*   **ツール**: **SQLmap**はSQLインジェクションの発見と悪用に特化したツールです。**OWASP ZAP**や**Burp Suite**のアクティブスキャンは、様々なインジェクション脆弱性を自動的に検出します。**Contrast Assess**のようなIASTツールは、アプリケーション実行中にデータフローを監視し、高精度でインジェクションを検出します。

### **A06:2025 - 安全が確認されていない不安な設計 (Insecure Design)**

*   **概要**: 実装段階ではなく、設計やアーキテクチャの欠陥に焦点を当てたカテゴリです（2021年のA04から順位は下降）。例えば、パスワード変更機能で現在のパスワードを確認しない、レート制限がない、といった設計上の問題が該当します。
*   **診断方法**: 開発の上流工程である設計段階で**脅威モデリング**を実施し、アプリケーションの設計図に対して想定される攻撃シナリオを洗い出します。また、セキュリティ要件が定義され、設計に組み込まれているかをレビューします。
*   **ツール**: 特定のツールで完全に自動化することは困難ですが、**OWASP Threat Dragon**などの脅威モデリングツールは、リスク分析を構造化して行うのに役立ちます。専門家による設計レビューやペネトレーションテストが最も効果的です。

### **A07:2025 - 識別と認証の失敗 (Authentication Failures)**

*   **概要**: ユーザーの身元確認やログイン機能に関する脆弱性です。ブルートフォース攻撃（パスワード総当たり）への耐性不足、弱いパスワードポリシー、多要素認証（MFA）の欠如、セッションIDの不適切な管理などが含まれます。
*   **診断方法**: ログイン機能に対して、パスワードリストを用いた自動試行やブルートフォース攻撃をシミュレーションし、ロックアウトや遅延などの対策が機能するか確認します。また、ログアウト後や長時間操作がない場合にセッションが適切に無効化されるかをテストします。
*   **ツール**: **Burp Suite**や**OWASP ZAP**のイントルーダー機能は、ログイン試行を自動化し、認証機構の強度をテストするのに最適です。また、**Astra Security**のようなDASTツールは、認証が必要な領域も含めてスキャンできます。

### **A08:2025 - ソフトウェアとデータの整合性の不具合 (Software and Data Integrity Failures)**

*   **概要**: ソフトウェアの更新プログラムや重要なデータが、改ざんされていないかという整合性の検証を欠いている状態を指します。署名なしでサードパーティ製コードやプラグインを読み込んだり、安全でないデシリアライゼーション（信頼できないデータをそのままオブジェクトに復元）したりするケースが該当します。
*   **診断方法**: CI/CDパイプラインの設定をレビューし、コードやコンテナイメージの署名検証が行われているか確認します。また、アプリケーションが外部から取得したデータをデシリアライズしている箇所を洗い出し、悪意のあるオブジェクトが注入されないかをテストします。
*   **ツール**: **Waratek RASP**のようなランタイム保護ツールは、JVMレベルで安全でないデシリアライゼーション攻撃を監視・遮断できます。SCAツール（**Snyk**等）は、改ざんされたり悪意のあるパッケージが混入していないかを検出する機能を備えつつあります。

### **A09:2025 - セキュリティログとモニタリングの失敗 (Security Logging and Monitoring Failures)**

*   **概要**: セキュリティ上重要なイベント（ログイン成功/失敗、特権操作、エラー等）が適切に記録・監視されていないため、攻撃の早期発見や事後調査が困難になる状態です。
*   **診断方法**: 実際に攻撃を試みるなどのシナリオに基づき、必要なイベントがログに正しく出力されるか確認します。また、そのログがセキュリティ情報イベント管理（SIEM）などの監視システムに送信され、アラートが適切に通知される仕組みになっているかを検証します。
*   **ツール**: **Splunk**や**ELK Stack**などのログ管理・分析ツールは、ログの一元管理やリアルタイム監視に不可欠です。**Waratek RASP**のようなツールは、ブロックした攻撃について、対象コード行やペイロードを含むリッチなコンテキスト情報を提供し、実用的なアラートを生成します。

### **A10:2025 - 例外条件の不適切な処理 (Mishandling of Exceptional Conditions)**

*   **概要**: 2025年版で新設されたカテゴリです。システムがエラーや予期せぬ状況に遭遇した際に、安全でない方法で動作してしまう問題を指します。例えば、エラーが発生した際にセキュリティチェックをバイパスしてしまう（フェイルオープン）、エラーメッセージにスタックトレースなどの機密情報を含んでしまう、などの状況が該当します。
*   **診断方法**: アプリケーションに対して異常な入力データや不正なリクエストを送信し、エラーハンドリングが適切に行われるかテストします。また、ソースコードをレビューし、`try-catch`ブロックなどの例外処理が、セキュリティを損なうことなく適切に実装されているか確認します。
*   **ツール**: **Waratek RASP**のようなランタイムツールは、アプリケーションの実行を深いレベルで制御し、例外発生時に「フェイルオープン」することを防ぎ、機密情報の漏洩をブロックします。IASTツール（**Contrast Assess**等）は、テスト実行中にエラーハンドリングの不備を動的に検出できます。

2025年のOWASP Top 10は、従来のコードレベルの脆弱性に加え、サプライチェーン全体や設計、ランタイムの挙動にまでリスクの範囲が広がっていることを示しています。
診断においても、SAST、DAST、IAST、SCA、RASPといった多様なツールを組み合わせ、開発から本番運用までのライフサイクル全体でセキュリティを確保するアプローチ（シフトレフトとシールドライト）が重要です。

---

## まとめ

| **カテゴリ (A01〜A10)** | **概要** | **診断方法** | **主なツール** |
| :--- | :--- | :--- | :--- |
| **A01:2025 - アクセス制御の不備** | ユーザーが本来の権限を超えてデータや機能にアクセスできる脆弱性。SSRF（サーバーサイドリクエストフォージェリ）を統合。 | ・URLパラメータやAPIリクエストを変更し、権限外の情報にアクセスできるか確認。<br>・URL指定機能に`localhost`や内部IPアドレスを指定し、応答を確認（SSRF）。 | ・**Burp Suite**<br>・**OWASP ZAP**（DASTツールによるリクエスト改ざん、認可バイパステストの効率化） |
| **A02:2025 - 安全構成のミス** | クラウド環境等での設定不備。デフォルト認証情報の放置、不要な機能・ポートの開放、詳細なエラーメッセージ表示など。 | ・サーバー、フレームワーク、クラウドサービスの設定ファイルをレビュー。<br>・デフォルトアカウント有無、デバッグモード無効化などを手動確認。 | ・**Nessus**<br>・**Nmap**（構成監査・脆弱性スキャン）<br>・**Scout Suite**（マルチクラウド環境のセキュリティ評価） |
| **A03:2025 - ソフトウェアサプライチェーンの破綻** | **【新設】** 依存ライブラリだけでなく、ビルドパイプライン等、開発・供給プロセス全体のリスク。依存関係混乱攻撃、悪意のあるパッケージ混入など。 | ・**ソフトウェア部品表（SBOM）** を作成・活用し、全コンポーネントを可視化。<br>・各コンポーネントの既知の脆弱性（CVE）を脆弱性DBで継続照合。 | ・**Snyk**<br>・**OWASP Dependency-Check**（SCAツールによる脆弱性コンポーネント検出）<br>・**Waratek RASP**（仮想パッチ適用による本番保護） |
| **A04:2025 - 暗号化の失敗** | 機密データが適切に保護されていない状態。古く脆弱な暗号アルゴリズム（SHA-1等）の使用、デフォルト鍵の利用、HTTPS未適用など。 | ・ブラウザ開発者ツール等でネットワーク通信がTLSで暗号化されているか確認。<br>・DB保存データ（パスワード等）がソルト付きハッシュ等で保護されているかコードレビュー。 | ・**testssl.sh**<br>・**SSLyze**（サーバーのSSL/TLS設定スキャン）<br>・**Checkmarx**（SASTツールによる弱い暗号化処理の特定） |
| **A05:2025 - インジェクション** | 信頼できないデータがコマンドやクエリの一部として解釈されることで発生。SQLインジェクション、XSSなど。 | ・入力フォームやURLパラメータに特殊文字やSQL文、スクリプトタグ等を送信し、エラーや動作変化を確認。 | ・**SQLmap**（SQLインジェクション発見・悪用専用）<br>・**OWASP ZAP**（アクティブスキャン）<br>・**Contrast Assess**（IASTツールによる高精度検出） |
| **A06:2025 - 安全が確認されていない不安な設計** | 実装段階ではなく、設計やアーキテクチャの欠陥に焦点。パスワード変更時に現在のPWを確認しない、レート制限欠如など。 | ・開発上流工程で**脅威モデリング**を実施し、設計図に対する攻撃シナリオを洗い出し。<br>・セキュリティ要件が設計に組み込まれているかレビュー。 | ・**OWASP Threat Dragon**（脅威モデリングによるリスク分析の構造化）<br>※完全な自動化は困難。専門家による設計レビューやペネトレーションテストが効果的。 |
| **A07:2025 - 識別と認証の失敗** | ユーザー識別・認証機能の脆弱性。ブルートフォース耐性不足、弱いパスワードポリシー、多要素認証（MFA）欠如、セッションIDの不適切な管理など。 | ・ログイン機能へのパスワードリスト攻撃やブルートフォース攻撃をシミュレーションし、ロックアウト等の対策有無を確認。<br>・ログアウト後や長時間操作なしでセッションが無効化されるかテスト。 | ・**Burp Suite**（イントルーダー機能）<br>・**OWASP ZAP**（認証機構の強度テスト）<br>・**Astra Security**（DASTツール） |
| **A08:2025 - ソフトウェアとデータの整合性の不具合** | ソフトウェア更新や重要データの整合性検証欠如。署名なしの外部コード読込、安全でないデシリアライゼーションなど。 | ・CI/CDパイプラインの設定をレビューし、コードやコンテナイメージの署名検証実施有無を確認。<br>・アプリケーションが外部データをデシリアライズしている箇所を洗い出し、悪意あるオブジェクト注入をテスト。 | ・**Waratek RASP**（ランタイムで安全でないデシリアライゼーション攻撃を監視・遮断）<br>・**Snyk**（改ざん・悪意パッケージ検出機能） |
| **A09:2025 - セキュリティログとモニタリングの失敗** | セキュリティ上重要なイベント（ログイン、特権操作、エラー等）の記録・監視が不十分で、攻撃の早期発見や事後調査が困難な状態。 | ・攻撃シミュレーション等で、必要なイベントがログに正しく出力されるか確認。<br>・ログが監視システムに送信され、アラートが適切に通知される仕組みか検証。 | ・**Splunk**<br>・**ELK Stack**（ログ管理・一元管理、リアルタイム監視）<br>・**Waratek RASP**（ブロックした攻撃のリッチなコンテキスト情報を提供） |
| **A10:2025 - 例外条件の不適切な処理** | **【新設】** システムがエラー等の予期せぬ状況に遭遇した際の安全でない動作。エラー時のセキュリティチェックバイパス（フェイルオープン）、スタックトレース等の機密情報漏洩など。 | ・異常な入力データや不正なリクエストを送信し、エラーハンドリングが適切に行われるかテスト。<br>・ソースコードの`try-catch`等の例外処理が、セキュリティを損なわず適切に実装されているかレビュー。 | ・**Waratek RASP**（ランタイムで例外発生時の「フェイルオープン」を防止、機密情報漏洩をブロック）<br>・**Contrast Assess**（IASTツールによるエラーハンドリング不備の動的検出） |

---

## 2025年版OWASP Top 10各カテゴリの詳細な対策方法と、組織における具体的な導入ポイント・ステップ

2025年版OWASP Top 10各カテゴリの詳細な対策方法と、組織における具体的な導入ポイント・ステップについて、以下の表で整理します。
2021年版から大きく拡張・新設されたカテゴリ（A03、A10など）を中心に、現代の開発プロセス全体を視野に入れた対策を網羅しています。

| **カテゴリ (A01〜A10)** | **より詳細な対策方法** | **組織における具体的な導入ポイント・ステップ** |
| :--- | :--- | :--- |
| **A01:2025 - アクセス制御の不備** | • **デフォルト拒否(Deny by Default)**の原則をサーバーサイドで徹底する。<br>• 認可ロジックはクライアントサイドのデータ（ヘッダーやクエリパラメータ）に**依存せず**、バックエンドで一貫して実装する。<br>• APIエンドポイントごとに必要な権限を定義し、**ミドルウェア**などで一元管理・検証する。<br>• 攻撃者がIDを改ざんする**BOLA**を防ぐため、オブジェクトIDへのアクセスには所有権の確認を必須とする。<br>• **SSRF対策**として、URL指定機能ではホワイトリスト方式でアクセス先を制限し、内部ネットワークへの通信はファイアウォールで厳格に制御する。 | **フェーズ1: 現状分析と脆弱性診断** <br>1. 既存アプリケーションの全エンドポイントを洗い出し、アクセス制御の実装状況を棚卸しする。<br>2. ペネトレーションテストや自動化ツールで、BOLAや権限昇格の脆弱性がないか検証する。<br><br>**フェーズ2: 認可機構の一元化** <br>1. フレームワークの認可機能やポリシーベースのアクセス制御を導入し、認可ロジックを一元管理する。<br>2. 非人間的アイデンティティ（CI/CDトークン、サービスアカウント等）の権限を定期的に見直し、最小権限の原則を適用する。<br><br>**フェーズ3: 継続的モニタリング** <br>1. アクセス制御の失敗をログ記録し、不審なアクセスパターンを監視する仕組みを構築する。 |
| **A02:2025 - 安全構成のミス** | • 環境ごとに異なる認証情報を使用した**ハードニングテンプレート**を整備し、Infrastructure as Codeで自動適用する。<br>• 不要な機能、サービス、ポート、デフォルトアカウントは**無効化または削除**する。<br>• クラウド環境では**CSPM**ツールを導入し、設定ミスを自動検出する。<br>• セキュリティヘッダー（HSTS、CSP等）を適切に設定し、定期的に有効性を検証する。 | **フェーズ1: 設定標準化** <br>1. OS、ミドルウェア、クラウドサービスごとに**セキュアな設定テンプレート**を作成する。<br>2. 全環境で一貫した設定が適用されるよう、**Infrastructure as Code**を導入する。<br><br>**フェーズ2: 自動化ツール導入** <br>1. **CSPM**ツールを導入し、クラウド環境の設定ミスを自動検出する。<br>2. 脆弱性スキャナーを定期的に実行し、設定不備がないか確認する。<br><br>**フェーズ3: 定期的な棚卸し** <br>1. 四半期ごとに不要な機能・サービスの有無をレビューし、削除する。 |
| **A03:2025 - ソフトウェアサプライチェーンの破綻** | • **ソフトウェア部品表**を作成・維持し、全依存関係（推移的依存関係を含む）を可視化する。<br>• **SCAツール**を導入し、既知の脆弱性を含むコンポーネントを自動検出する。<br>• パッケージ取得時に**署名検証**やハッシュ検証を実施し、改ざんされたコンポーネントの混入を防ぐ。<br>• CI/CDパイプラインへのアクセス制御を強化し、ビルド環境の**整合性検証**を実施する。<br>• 信頼できるリポジトリからのみコンポーネントを取得し、**Package Firewall**などの導入で悪意あるパッケージをブロックする。<br>• **ハニートークン**を配置し、サプライチェーン侵害の早期発見のトリガーとする。 | **フェーズ1: 可視化と現状把握** <br>1. **SCAツール**を導入し、全アプリケーションの依存関係を自動スキャンする。<br>2. 初回スキャンで検出された脆弱性コンポーネントの一覧を作成し、優先順位付けする。<br><br>**フェーズ2: プロセス改善** <br>1. 新規ライブラリ導入時に、脆弱性・ライセンス・メンテナンス状況を評価するプロセスを確立する。<br>2. CI/CDパイプラインへのアクセス権限を見直し、**最小権限の原則**を適用する。<br>3. パッケージ取得時の署名検証を必須とする。<br><br>**フェーズ3: 継続的防御** <br>1. 新たな脆弱性公開時にアラートを受け取る仕組みを構築する。<br>2. **Package Firewall**などのツールを導入し、悪意あるパッケージの混入をリアルタイムでブロックする。<br>3. サプライチェーン攻撃を想定した**インシデント対応訓練**を実施する。 |
| **A04:2025 - 暗号化の失敗** | • アプリケーションで処理・保存・転送するデータを**機密性に基づき分類**する。<br>• 機密データは保存時に強力な暗号化アルゴリズム（AES-256等）で暗号化する。<br>• 転送時には**TLS 1.3**など最新の安全なプロトコルを使用し、**HSTS**を有効にする。<br>• パスワードは**Argon2**、**bcrypt**、**PBKDF2**などの適応的でソルト付きのハッシュ関数を使用する。<br>• **暗号鍵のライフサイクル管理**を確立し、定期的なローテーションを実施する。 | **フェーズ1: データインベントリ作成** <br>1. アプリケーションが取り扱う全データを洗い出し、機密度に応じて分類する。<br>2. 保存する必要のない機密データは保持しない方針を徹底する。<br><br>**フェーズ2: 暗号化実装** <br>1. 保存データ暗号化の対象を特定し、暗号化方式を決定する。<br>2. 転送時暗号化を適用し、TLS設定を**testssl.sh**等で定期的に検証する。<br>3. パスワード保存方式を最新の安全なハッシュ関数に移行する。<br><br>**フェーズ3: 鍵管理体制構築** <br>1. 鍵管理ポリシーを策定し、HSMや鍵管理サービスを導入する。 |
| **A05:2025 - インジェクション** | • **パラメータ化クエリ**、**プリペアドステートメント**、または安全な**ORM**を使用する。<br>• ユーザー入力に対する**ホワイトリスト方式のバリデーション**をサーバーサイドで実装する。<br>• 特殊文字が必要なコンテキストでは、インタプリタに応じた適切な**エスケープ処理**を行う。<br>• **SAST**、**DAST**、**IAST**ツールをCI/CDパイプラインに統合し、早期発見する。 | **フェーズ1: 開発プロセス改善** <br>1. 全開発者に安全なコーディング手法のトレーニングを実施する。<br>2. コーディング規約にインジェクション対策を明記する。<br><br>**フェーズ2: ツール導入** <br>1. 既存コードベースにSASTツールを実行し、脆弱性を洗い出す。<br>2. CI/CDパイプラインにSAST/DASTツールを組み込む。 |
| **A06:2025 - 安全が確認されていない不安な設計** | • アプリケーション設計段階で**脅威モデリング**を実施し、潜在的なリスクを特定する。<br>• **安全な設計パターン**のライブラリを整備し、再利用可能にする。<br>• ユーザーストーリーにセキュリティ要件を組み込み、**ミスユースケース**を作成する。<br>• ビジネスロジックの脆弱性（自動化攻撃、認証情報の露出、エラーメッセージからの情報漏洩等）を設計段階で考慮する。 | **フェーズ1: 人材育成と体制構築** <br>1. アプリケーションセキュリティの専門家を育成・確保し、設計レビューに関与させる。<br>2. **セキュア開発ライフサイクル**を定義し、設計フェーズのセキュリティチェックポイントを設定する。<br><br>**フェーズ2: 設計プロセス改善** <br>1. 重要な機能について、**脅威モデリング**を義務化する。<br>2. 設計レビューでセキュリティ観点のチェックリストを活用する。<br><br>**フェーズ3: テスト自動化** <br>1. 脅威モデルに基づいたテストを作成し、CI/CDで自動実行する。 |
| **A07:2025 - 認証の失敗** | • **多要素認証**を実装し、パスワードのみの認証から脱却する。<br>• OAuthトークンエンドポイントとJWTの両方を本番環境で**継続的に監視**する。<br>• JWTの検証では、有効期限（exp）、オーディエンス（aud）、スコープを厳格にチェックする。<br>• ログイン試行失敗回数に制限を設け、アカウントロックアウトや遅延を導入する。<br>• 適切な**セッションタイムアウト**を設定し、ログアウト時にサーバーサイドでセッションを無効化する。 | **フェーズ1: 認証基盤強化** <br>1. 重要システムから順に**MFA**を段階的に導入する。<br>2. パスワードポリシーを強化し、脆弱なパスワードを許可しないようにする。<br><br>**フェーズ2: 監視体制構築** <br>1. OAuthトークンエンドポイントの可用性・応答の正確性を監視する仕組みを導入する。<br>2. 取得したトークンで実際のAPIを呼び出し、エンドツーエンドで認証フローを検証するマルチステップ監視を実装する。<br><br>**フェーズ3: セッション管理改善** <br>1. セッション管理の実装をレビューし、安全な方式に改善する。 |
| **A08:2025 - ソフトウェアとデータの整合性の不具合** | • ソフトウェア更新やデータ取得時に**電子署名**やハッシュ検証を実施する。<br>• **安全でないデシリアライゼーション**を防ぐため、信頼できないデータのデシリアライズを避け、許可リスト方式でクラスを制限する。<br>• **CI/CDパイプライン**のセキュリティを強化し、ビルド成果物の改ざんを防ぐ。<br>• コードやコンテナイメージのダウンロード時に**整合性検証**を実施する。<br>• **DASTツール**を活用し、実行時に整合性に関する脆弱性が存在しないか検証する。 | **フェーズ1: CI/CDセキュリティ強化** <br>1. CI/CDパイプラインへのアクセス権限を見直し、最小権限の原則を適用する。<br>2. ビルドプロセスで使用するツールやスクリプトの整合性検証を実施する。<br><br>**フェーズ2: デシリアライゼーション対策** <br>1. デシリアライズを行う箇所を特定し、許可リスト方式での検証を実装する。<br><br>**フェーズ3: ランタイム監視** <br>1. **DASTツール**を活用し、実行時に整合性に関する脆弱性がないか定期的に検証する。 |
| **A09:2025 - ログ監視・アラートの不備** | • ログイン/ログアウト、アクセス制御失敗、特権操作など、セキュリティ上重要なイベントを**漏れなくログ記録**する。<br>• ログは分析に適した形式で一元管理し、**定期的なバックアップ**を実施する。<br>• **SIEM**などの監視システムを導入し、疑わしいアクティビティをリアルタイムで検知・アラートする。<br>• 検知ルールは定期的にテストし、**攻撃シミュレーション**で有効性を検証する。<br>• **インシデント対応計画**を策定し、定期的に訓練を実施する。 | **フェーズ1: ロギング基盤構築** <br>1. どのイベントをログ記録すべきか定義する。<br>2. **ログ管理・分析ツール**（SIEM等）を導入し、ログを一元管理する。<br><br>**フェーズ2: 検知ルール整備** <br>1. 重要なイベントに対するアラートしきい値を設定する。<br>2. ログ収集の欠落がないか定期的に検証する（収集失敗は検知失敗の50%を占める）。<br><br>**フェーズ3: 継続的検証** <br>1. **Breach and Attack Simulation**ツール等で攻撃をシミュレーションし、検知ルールの有効性を定期的にテストする。<br>2. **インシデント対応計画**を策定し、定期的に訓練を実施する。 |
| **A10:2025 - 例外処理の不備** | • エラーハンドリングは常に**フェイルセーフ**（安全な状態に移行）するように設計する（フェイルオープンを防ぐ）。<br>• エラーメッセージにはスタックトレースや内部パス情報などの**機密情報を含めない**。<br>• 例外発生時もセキュリティチェック（認証・認可）が**バイパスされない**ことを検証する。<br>• 未処理の例外がシステム全体を停止させないよう、**グローバルな例外ハンドラ**を実装する。<br>• **IAST**や**RASP**などのランタイムツールで、例外処理の不備を動的に検出する。 | **フェーズ1: 現状分析** <br>1. 既存アプリケーションのエラーハンドリング実装をレビューし、機密情報漏洩のリスクを特定する。<br>2. 異常な入力データでテストし、エラーハンドリングが適切に行われるか検証する。<br><br>**フェーズ2: 実装改善** <br>1. グローバルな例外ハンドラを実装し、エラーレスポンスの形式を統一する。<br>2. エラーメッセージに内部情報を含めないよう、エラーページ/レスポンスをテンプレート化する。<br><br>**フェーズ3: ランタイム検証** <br>1. **IAST**や**RASP**ツールを導入し、例外処理の不備を本番環境含めて動的に検出する仕組みを構築する。 |

これらの対策を組織全体で体系的に導入することで、OWASP Top 10 2025のリスクを効果的に低減できます。特に、2025年版で重視されているのは、個別のコード脆弱性対策から**開発プロセス全体の安全性**へのシフトです。ソフトウェアサプライチェーン対策（A03）や例外処理（A10）など、従来の診断手法では検出が難しかったリスクに対しても、開発初期段階（シフトレフト）と本番運用（シールドライト）の両面から対策を講じることが重要です。

---
