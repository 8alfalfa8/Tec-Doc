# 🧭 監査の観点からの設計思想（Audit-Oriented Design Principles）
「**監査の観点からの設計思想**」とは、システムが**利用後・運用中にどのように説明責任を果たせるか（Accountability）**を設計段階から確保する思想です。
セキュリティ設計が「防御」を目的とするのに対し、監査設計は「**証跡による可視化と検証可能性**」を目的とします。

以下に体系的に整理します。

---

## 1. **説明責任（Accountability）の確保**

* すべての操作・変更について「**誰が・いつ・何をしたか**」を明確に追跡できるようにする。
* 設計段階で「行為主体（User, System, Process）」を識別できる仕組みを作る。
* 例：

  * 監査ログにユーザーIDだけでなくIP、端末情報、セッションIDを付与。
  * 自動処理ジョブにも固有の実行主体（サービスアカウント）を設定。

---

## 2. **完全な証跡（Complete Audit Trail）**

* 業務・システムに関わる重要操作を**欠落なく記録**する。
* 設計時に「どの操作を監査対象にするか」を明確に定義。
* 例：

  * データ登録・更新・削除・承認・設定変更はすべてログ化。
  * API呼び出し結果やレスポンスコードも含めて保存。

---

## 3. **改ざん耐性（Integrity & Tamper Resistance）**

* 証跡が**改ざん・削除・隠蔽されない設計**にする。
* 例：

  * ログはWORM（Write Once Read Many）ストレージに保存。
  * ハッシュ値を生成し、署名またはブロックチェーン的にチェーン化。
  * 書き込み専用の監査DBまたはAWS CloudTrail + S3バージョニング。

---

## 4. **証跡の一貫性（Consistency）**

* 各層（アプリ・DB・OS・ネットワーク）で記録内容を**突合可能な構造**にする。
* 例：

  * 共通のリクエストID／トランザクションIDで関連ログを紐づける。
  * タイムスタンプをUTC統一し時刻同期（NTP）を強制。

---

## 5. **分離性と独立性（Independence of Audit Function）**

* ログ収集・監査機能は業務アプリケーションから**独立**させる。
* 目的：業務ロジックの改ざんや削除操作から監査証跡を保護。
* 例：

  * 別プロセスまたは別システム（SIEM, CloudWatch, Splunkなど）で監査収集。
  * 管理者自身の操作も第三者により検証可能な設計。

---

## 6. **再現可能性（Reproducibility）**

* 記録されたログや設定情報から**事後に状態を再現できる**こと。
* 例：

  * 設定変更履歴をGit管理し、いつでもロールバック可能。
  * 業務イベントをID単位で時系列復元できる監査ビューを設計。

---

## 7. **監査容易性（Auditability）**

* 監査人が**容易に検証できるように**設計する。
* 例：

  * ログフォーマットを統一し、メタデータを明確にする（JSON形式など）。
  * 「検索キー（ユーザーID・処理ID・期間）」で容易に追跡可能。
  * SIEM連携やダッシュボード化を考慮。

---

## 8. **保持期間とライフサイクル管理**

* ログ・証跡の**保存期間、アーカイブ、廃棄ポリシー**を設計段階で定義。
* 例：

  * 法令・監査基準に基づき「7年保持」などを設定。
  * 保存容量とパフォーマンスのバランスを考慮（例：熱・冷ログ分離）。

---

## 9. **アクセス制御とプライバシー配慮**

* ログは監査対象だが**機密情報の塊でもある**ため、アクセス権を厳格に管理。
* 例：

  * 監査ログへのアクセス権を「監査担当者のみ」に限定。
  * ログ内の個人情報や機密データはマスキング・トークン化。

---

## 10. **継続的監査（Continuous Monitoring）**

* 単なる記録ではなく、**異常検知・分析・通知**を自動化。
* 例：

  * SIEMやCloudTrail＋GuardDuty＋Security Hubなどの連携。
  * リアルタイムでアラート発火 → 監査担当者へ自動通知。

---

## 🧩 領域別の監査設計例

| 領域        | 主な監査対象            | 設計思想                                      |
| --------- | ----------------- | ----------------------------------------- |
| アプリケーション  | 操作履歴、認証・認可イベント    | トランザクションID紐づけ・業務ログ分離                      |
| データベース    | DML操作、権限変更、スキーマ更新 | DB監査ログ（Oracle AUDIT / PostgreSQL pgaudit） |
| OS・ミドルウェア | ログイン・sudo・設定変更    | syslog統合 + 監査サーバ転送                        |
| ネットワーク    | 通信経路、外部アクセス       | FWログ、プロキシログ、TLS証跡                         |
| クラウド      | APIコール、設定変更       | CloudTrail, Config, IAM Access Analyzer   |
| 運用        | ジョブ実行、インシデント対応    | 手順書履歴、承認ワークフロー                            |

---

## 🧠 設計思想の要約

| 観点   | 設計思想のキーワード   |
| ---- | ------------ |
| 信頼性  | 改ざん不可・完全性    |
| 説明責任 | 誰が・いつ・何をしたか  |
| 独立性  | 監査ログと業務処理を分離 |
| 透明性  | 一貫性・再現性・可視化  |
| 継続性  | ライフサイクルと自動監査 |

---

## 📘 参考フレームワーク

* **ISO/IEC 27001 / 27002**：ログ管理、アクセス制御、監査要件を定義
* **NIST SP 800-53**：AU系統（Audit and Accountability）コントロール
* **J-SOX / 内部統制**：証跡整備・変更管理・権限統制
* **AWS Well-Architected Framework（Security & Operational Excellence）**：監査ログとモニタリングの設計指針

---
