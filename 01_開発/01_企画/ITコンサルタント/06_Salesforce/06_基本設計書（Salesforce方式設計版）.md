# ◆ 基本設計書（Salesforce方式設計版）

以下は、**CRM基本設計書（Salesforce方式設計版）**です。
要件定義書をインプットとし、Salesforce特有の設計判断（方式）を明確化することを目的としています。

---

## 1. 文書概要

### 1.1 文書目的

本書は、CRM要件定義書に基づき、Salesforceを用いたCRMシステムの
基本設計（方式設計）を定義し、詳細設計・開発の指針とする。

### 1.2 前提・参照資料

* CRM要件定義書（Salesforce対応・詳細版）
* Salesforce 標準機能仕様
* セキュリティ・監査要件

---

## 2. 全体アーキテクチャ設計

### 2.1 システム構成

* Salesforce Sales Cloud（本番Org）
* Sandbox（Dev / Partial / Full）
* 外部連携システム（基幹系）

### 2.2 論理構成図（記載方針）

* UI（Lightning Experience / Mobile）
* 業務ロジック（Flow / Apex）
* データ（標準＋カスタムオブジェクト）

---

## 3. データモデル方式設計

### 3.1 標準オブジェクト利用方針

* Account：顧客（法人）
* Contact：顧客担当者
* Opportunity：商談
* Activity：活動履歴

### 3.2 カスタムオブジェクト方針

* 標準で表現できない業務エンティティのみ作成
* 過度な正規化は行わない

### 3.3 リレーション設計方針

* 主従関係は最小限
* 権限・削除影響を考慮

---

## 4. 業務ロジック方式設計

### 4.1 自動化方式

* 原則：Flowファースト
* Apexは以下の場合のみ使用

  * 複雑なループ処理
  * 外部API連携
  * 大量データ処理

### 4.2 レコードトリガ設計方針

* 1オブジェクト1トリガ（Flow）
* Before / Afterの使い分け明確化

---

## 5. 画面方式設計

### 5.1 UI基本方針

* Lightning Experienceを標準
* 標準画面＋Lightning App Builder中心

### 5.2 LWC利用方針

* 標準UIで不足する場合のみ採用
* 再利用性を考慮

---

## 6. 権限・共有モデル方式設計（重要）

### 6.1 全体方針

* OWDは原則「非公開」
* 権限セット中心の設計

### 6.2 ロール設計

* 部門階層を反映

### 6.3 項目レベルセキュリティ

* 個人情報項目は参照制限

---

## 7. 外部連携方式設計

### 7.1 連携方式

* REST API（同期）
* Platform Event（非同期）

### 7.2 認証方式

* Named Credentialを使用

---

## 8. 非機能方式設計

### 8.1 性能設計

* 同時利用者数想定
* ガバナ制限考慮

### 8.2 可用性・バックアップ

* Salesforce標準SLA前提
* 外部バックアップ検討

### 8.3 監査・ログ

* 操作ログ
* 設定変更履歴

---

## 9. 開発・運用方式設計

### 9.1 開発方式

* Sandbox + Git
* SFDX利用

### 9.2 リリース方式

* Change Set / CI/CD

### 9.3 運用方式

* 本番直変更禁止
* 変更管理プロセス

---

## 10. 制約・留意事項

* Salesforceガバナ制限遵守
* 標準機能逸脱時は設計承認必須

---

## 11. 次工程への引継事項

* 詳細設計で確定すべき項目
* 未決事項一覧

---

※ 本書は詳細設計・レビュー工程の基準文書とする。

---

## この基本設計書の位置づけ（実務的に重要）

この文書は次を明確にするためのものです。

* 「**なぜこの設計にしたのか**（判断理由）」
* 「**どこまでが標準で、どこからがカスタムか**」
* 「**Flowでやる／Apexでやらない理由**」
* 「**権限・共有モデルをどう統制するか**」

👉 **レビュー・監査で“突っ込まれるポイント”を先に潰す文書**です。

---

## 工程上の使い分けイメージ

| 工程       | 使う文書                   |
| -------- | ---------------------- |
| 要件定義     | CRM要件定義書               |
| **基本設計** | **本書（方式判断）**           |
| 詳細設計     | オブジェクト定義／Flow設計／Apex設計 |
| 開発       | 詳細設計書                  |
| レビュー     | 工程別チェックリスト             |

---

## 特に評価されるポイント（Salesforce案件）

* 🔹 **OWD非公開前提の明文化**
* 🔹 **1オブジェクト1トリガ（Flow）方針**
* 🔹 **Apex使用条件の明示**
* 🔹 **ガバナ制限を“設計で”考慮**

金融・公共・大企業案件では
👉「**この基本設計があるかどうか**」で案件品質が判断されることも多いです。

---

