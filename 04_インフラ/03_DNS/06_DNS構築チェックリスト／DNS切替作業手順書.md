# DNS構築チェックリスト／DNS切替 作業手順書（分単位タイムライン）【金融向け】

---

## 1. 本書の位置づけ

* DNS詳細設計書・DNS切替計画書に基づく**当日オペレーション用手順書**
* 金融・公共案件における**無停止切替・即時切戻し**を目的とする
* 作業者は本書をチェックリストとして使用する

---

## 2. 事前準備チェックリスト（T-7日〜前日）

### 2.1 DNS構築確認

* [ ] BIND設定完了（named-checkconf OK）
* [ ] ゾーンファイル確認（named-checkzone OK）
* [ ] Route53 Hosted Zone作成済
* [ ] DNSSEC設定完了（Public Zone）
* [ ] Unbound再帰設定確認

### 2.2 TTL短縮確認

* [ ] 対象レコード TTL = 300秒以下
* [ ] SOA Minimum TTL 短縮済
* [ ] 旧DNS・新DNS双方で一致

### 2.3 並行稼働事前確認

* [ ] 新DNSでdig疎通確認
* [ ] 旧DNS継続稼働確認
* [ ] NS並行登録準備完了

---

## 3. 切替当日体制（必須）

| 役割     | 担当 | 主な作業       |
| ------ | -- | ---------- |
| 統括責任者  | ○○ | Go/No-Go判断 |
| DNS作業者 | ○○ | 設定変更       |
| 監視担当   | ○○ | 影響確認       |
| 記録担当   | ○○ | 作業記録       |

---

## 4. DNS切替 当日タイムライン（分単位）

### T-30分：事前確認

* [ ] 全関係者集合
* [ ] 監視強化モード開始
* [ ] digによる現状確認

```
dig example.com @8.8.8.8
dig example.com @1.1.1.1
```

---

### T-15分：TTL最終確認

* [ ] TTL = 300秒以下
* [ ] キャッシュ残存なし

---

### T0：DNS切替作業開始

#### ① NS並行登録（推奨）

* [ ] Route53 NSに新DNS追加
* [ ] 旧DNSは削除しない

#### ② レコード切替

* [ ] A / CNAME 新向き設定
* [ ] 変更内容ダブルチェック

---

### T+5分：即時疎通確認

* [ ] dig（外部Resolver）
* [ ] dig（内部Resolver）
* [ ] アプリ疎通確認

---

### T+15分：影響確認

* [ ] 応答時間正常
* [ ] NXDOMAIN増加なし
* [ ] エラーログなし

---

### T+30分：安定確認

* [ ] 主要ISPから名前解決OK
* [ ] 利用部門影響なし

---

## 5. 切戻し手順（即時対応用）

### 切戻し判断条件（1つでも該当）

* 名前解決不可
* 大量SERVFAIL
* 業務影響報告あり

### 切戻し手順

1. NSを旧DNS優先に戻す
2. レコードを旧値へ復旧
3. TTL短縮状態を維持
4. dig確認

---

## 6. 切替完了処理

### T+24時間

* [ ] 旧DNS参照なし確認
* [ ] NSから旧DNS削除
* [ ] TTLを3600秒へ復旧

---

## 7. 作業後報告（必須）

* 作業日時
* 実施内容
* 問題有無
* 切戻し有無
* 証跡（ログ・スクショ）

---

## 8. 監査向け確認観点

| 観点   | 本手順での担保 |
| ---- | ------- |
| 無停止  | 並行NS    |
| 即時復旧 | 切戻し定義   |
| 統制   | 役割分担    |
| 再現性  | チェックリスト |

---

## 9. 付録：確認コマンド集

```
dig example.com NS
dig example.com A
rndc status
```

---

# ◆ 本手順書についての説明

この資料は **切替当日に“読みながらそのまま実行できる”** ことを最優先にしています。

---

## この手順書の現場向けポイント

### ✅ 当日オペレーションで強い点

* **分単位タイムライン（T-30 / T0 / T+5…）**
* 作業・監視・判断を**役割分離**
* **切戻し条件が明確**（迷わず戻せる）
* チェックボックス形式 → **読み飛ばし防止**

### ✅ 金融・公共監査で評価される点

| 監査観点 | 本手順書での担保  |
| ---- | --------- |
| 無停止  | NS並行登録    |
| 即時復旧 | TTL短縮＋切戻し |
| 統制   | 体制・役割定義   |
| 再現性  | チェックリスト化  |
| 証跡   | 作業後報告     |

---

## 実運用でのおすすめ使い方

* **印刷して当日配布（赤ペンチェック）**
* 監視担当は **T+5 / T+15 / T+30** を重点確認
* 統括責任者は
  → *切戻し判断条件* のみ常に参照

---

