# DNSセキュリティ詳細設計書（DNSSEC・TSIG）

## 1. 文書概要

### 1.1 目的

本書は、金融・公共系システムにおけるDNSセキュリティ要件を満たすため、DNSSECおよびTSIGを中心としたDNSセキュリティの詳細設計を定義する。

### 1.2 適用範囲

* 権威DNS（BIND9）
* 内部DNS／外部DNS
* オンプレミスおよびクラウド（IaaS）環境

### 1.3 セキュリティ基準

* FISC安全対策基準
* 政府情報システムのためのセキュリティ評価制度（ISMAP）
* NISCガイドライン

---

## 2. DNS脅威モデル

### 2.1 想定脅威

| 脅威          | 内容       |
| ----------- | -------- |
| キャッシュポイズニング | 偽応答の混入   |
| なりすまし       | 権威DNS偽装  |
| ゾーン情報漏洩     | AXFR不正実行 |
| DoS/DDoS    | 大量問い合わせ  |

### 2.2 対策マッピング

| 脅威   | 対策        |
| ---- | --------- |
| 偽応答  | DNSSEC    |
| 不正転送 | TSIG      |
| 情報収集 | Version隠蔽 |
| DDoS | RRL       |

---

## 3. DNSSEC設計

### 3.1 DNSSEC概要

DNSSECはDNS応答に電子署名を付与し、応答の真正性・完全性を保証する。

### 3.2 鍵構成設計

| 鍵種別 | 役割     | 鍵長            | ローテーション |
| --- | ------ | ------------- | ------- |
| KSK | 親ゾーン登録 | RSA 2048      | 1–2年    |
| ZSK | レコード署名 | RSA 1024/2048 | 3–6か月   |

### 3.3 鍵管理方針

* KSKはオフライン管理
* ZSKはDNSサーバ上で管理
* 鍵生成・更新作業は二名体制

### 3.4 ゾーン署名設計

* inline-signing：有効
* auto-dnssec：maintain

---

## 4. DNSSEC運用設計

### 4.1 鍵ロールオーバー手順（概要）

1. 新ZSK生成
2. 事前公開（Pre-Publish）
3. 切替
4. 旧鍵無効化

### 4.2 監視項目

| 項目        | 内容        |
| --------- | --------- |
| RRSIG有効期限 | 期限切れ監視    |
| DNSSEC失敗率 | SERVFAIL率 |

---

## 5. TSIG設計

### 5.1 TSIG概要

TSIGはゾーン転送および制御通信における認証・完全性を確保する。

### 5.2 TSIG鍵設計

| 項目     | 内容          |
| ------ | ----------- |
| アルゴリズム | hmac-sha256 |
| 鍵長     | 256bit      |
| 保管     | OS権限分離      |

### 5.3 TSIG利用範囲

* ゾーン転送（AXFR/IXFR）
* rndc通信

---

## 6. TSIG設定設計（BIND）

### 6.1 鍵定義

```
key "zonetransfer-key" {
    algorithm hmac-sha256;
    secret "xxxxxxxx";
};
```

### 6.2 ゾーン転送制御

```
allow-transfer { key zonetransfer-key; };
```

---

## 7. その他DNSセキュリティ対策

### 7.1 再帰制御

* recursion：no（権威DNS）
* ACLによる内部限定

### 7.2 Rate Limit（RRL）

* responses-per-second：5
* slip：2

### 7.3 ログ・監査

* クエリログ取得
* 6か月以上保管

---

## 8. 運用・監査対応

### 8.1 運用体制

* 管理者／承認者分離
* 作業記録保存

### 8.2 監査証跡

| 項目   | 証跡    |
| ---- | ----- |
| 鍵更新  | 作業ログ  |
| 設定変更 | 変更申請書 |

---

## 9. 障害・インシデント対応

### 9.1 DNSSEC障害

* SERVFAIL多発時はDNSSEC検証ログ確認

### 9.2 TSIG障害

* 転送失敗時は鍵不一致確認

---

## 10. チェックリスト（金融・公共向け）

* [ ] DNSSEC有効化
* [ ] KSK/ZSK分離
* [ ] TSIG適用
* [ ] 再帰制御
* [ ] RRL有効
* [ ] ログ保管

---

## 11. 付録

### 11.1 使用コマンド

* dnssec-keygen
* dnssec-signzone
* rndc

### 11.2 用語集

* DNSSEC
* KSK / ZSK
* TSIG
