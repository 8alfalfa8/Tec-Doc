# ◆ DNSをAWSのRoute53へ移行する必要性

**オンプレミスのWebアプリケーションをAWSへ移行する際、DNS（オンプレミスで管理しているドメイン名の名前解決）をAWSのRoute53へ移行する必要があるか**は、設計方針と運用要件によって判断します。
以下に **理由・原因・移行設計・移行作業詳細** を、実務視点で整理します。

---

## ✅ 1. Route53へ移行する必要性

| 利用形態            | Route53移行要否               |
| --------------- | ------------------------- |
| 公開Web（パブリック向け）  | ✔ 必要／推奨                   |
| AWS内部のみ利用       | ✔ 推奨（Private Hosted Zone） |
| オンプレ既存DNSを残す内部系 | ○ 条件付き可能                  |
| 既存DNSのまま変更なしで運用 | ×（推奨されない）                 |

👉 **結論：外部公開／AWS内部向けについてはRoute53へ移行することが原則です。**
理由は主に **可用性・運用効率・名前解決の整合性** にあります。

---

## 2. 移行が必要な主な理由と原因

### ① 可用性とグローバル分散対応

* AWSのRoute53はAWSグローバルインフラに分散配置されており、高可用性を標準提供。
* オンプレDNSでは、外部からの名前解決負荷や災害対策を確実に担保するのが難しい。

👉 *オンプレDNSによるパブリック名前解決は可用性・スケーラビリティの観点でリスクが高い。*

---

### ② DNS・アプリ構成の一貫性

* WebアプリケーションがAWS内へ移ると、バックエンドやロードバランサ（ALB/NLB）の名前解決先もAWSリソース。
* **Route53で管理することで、DNS名とAWSリソースの紐付けが自然になる。**

---

### ③ 運用効率と一元管理

* レコード変更（例：ELBのAレコード）はRoute53で完結。
* オンプレDNSを残す場合、Route53 → オンプレDNS間でゾーン委任・フォワードなど余計な構成が必要になる。

---

### ④ ドメイン戦略・セキュリティ

* パブリック向けDNSは権威DNSとしてRoute53で管理するのが一般的。
* 内部専用DNSは **Route53 Private Hosted Zone** でAWS VPC内に閉域管理可。

---

## 3. 移行設計（高レベル）

以下は、**WebアプリケーションのDNSをRoute53へ移行する一般設計例**です。

---

### ① DNSゾーンの把握

| 種別       | 例                                         |
| -------- | ----------------------------------------- |
| パブリックゾーン | example.com                               |
| サブドメイン   | www.example.com |
| 内部ゾーン    | internal.example.com                      |

---

### ② 移行方針の決定

| 項目        | 方針                          |
| --------- | --------------------------- |
| ルートゾーン    | Route53で管理                  |
| 内部解決      | Route53 Private Hosted Zone |
| オンプレDNS継続 | フォワードまたは委任で参照可能に            |

---

### ③ 名前解決フロー（移行後）

```
Client
  ├ Public DNS > Route53 Public
  └ AWS Private Resolver > Route53 Private
```

必要であれば **オンプレDNSからRoute53への条件付きフォワード** を設定し、AWS内の名前解決をRoute53に委ねる設計にもできます。

---

## 4. 具体的な移行作業（ステップ）

### Step 0. 準備

* AWSアカウントのRoute53アクセス権を用意
* 移行対象ゾーン一覧を確定
* TTLを短く設定（300秒程度）

---

### Step 1. Route53 Hosted Zone作成

**パブリックゾーン例**

```
Route53 Console → Hosted Zone → example.com（Public）
```

**Private Hosted Zone例**

```
Route53 Console → Hosted Zone → internal.example.com（Private）
→ VPC 関連付け
```

---

### Step 2. レコード移行

* A / AAAA / CNAME / MX / TXT など既存レコードをRoute53へ登録

  * CloudFront / ALB / NLB などAWS固有リソースの場合はAliasレコードで登録
* 内部ゾーンはRoute53 Privateに登録

---

### Step 3. 旧DNSと並行運用

* NSレコードを旧DNSとRoute53で並列
* TTLを短くして切替影響を最小化

---

### Step 4. 切替

* 最終確認後、旧DNSから **Route53のNS** へ切替
* 内部DNSがある場合はフォワーダや条件付きフォワードをAWS Resolverで設定

---

### Step 5. 検証

* `dig example.com @8.8.8.8`
* `dig example.com @Route53 Resolver IP`
* アプリケーションアクセス確認

---

### Step 6. 旧DNS縮退・廃止

* 切替安定後、旧DNS上の該当ゾーンを削除
* TTLを元に戻す

---

## 5. リスクと対策

| リスク         | 対策                    |
| ----------- | --------------------- |
| DNSキャッシュが残る | TTL事前短縮               |
| 頻繁なレコード変更遅延 | Alias利用（Route53ネイティブ） |
| 切替ミス        | 並行運用＋即時切戻し計画          |

---

## 6. 要点まとめ

* **外部公開DNSはRoute53へ移行すべき**（可用性・運用性・AWS整合性）
* 内部DNSも **Private Hosted Zoneで管理可能**
* 既存オンプレと併存する場合は **フォワード or 委任設計**
* TTL短縮・並行運用・検証は切替の鉄則

---


