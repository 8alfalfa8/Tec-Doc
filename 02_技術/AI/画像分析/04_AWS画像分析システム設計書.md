# AWS画像分析システム 設計書テンプレート

（金融機関・自治体向け／監査対応）

---

## 1. 文書概要

### 1.1 目的

本設計書は、AWS上に構築する画像分析システムについて、
機能要件・非機能要件を満たすための設計内容を定義することを目的とする。

### 1.2 適用範囲

* 本番環境
* 検証／開発環境
* 画像取得〜AI分析〜業務連携までの全体

### 1.3 前提条件・制約

* AWSリージョン：〇〇（例：ap-northeast-1）
* 個人情報・機微情報を含む画像を取り扱う
* 金融／公共向けセキュリティ・監査要件に準拠

---

## 2. システム概要

### 2.1 システム全体概要

本システムは、入力された画像データをAIにより分析し、
その結果を業務システムへ連携することを目的とする。

### 2.2 主なユースケース

* 帳票・請求書OCR
* 監視画像の異常検知
* 製品外観検査

---

## 3. 論理設計

### 3.1 論理構成図

（構成図貼り付け）

### 3.2 機能一覧

| 機能ID | 機能名  | 概要                    |
| ---- | ---- | --------------------- |
| F-01 | 画像取込 | API/S3経由で画像取得         |
| F-02 | 前処理  | リサイズ・補正・マスキング         |
| F-03 | AI分析 | Rekognition/Textract等 |
| F-04 | 後処理  | 業務項目変換・判定             |
| F-05 | 結果連携 | DB保存・通知               |

### 3.3 処理フロー

1. 画像アップロード
2. 前処理実行
3. AI分析
4. 業務ルール判定
5. 結果保存・通知

---

## 4. 物理設計

### 4.1 AWSアカウント構成

* 管理アカウント
* 本番アカウント
* 検証アカウント

### 4.2 ネットワーク設計

#### 4.2.1 VPC設計

| 項目   | 内容          |
| ---- | ----------- |
| CIDR | 10.0.0.0/16 |
| AZ   | 2AZ以上       |

#### 4.2.2 サブネット構成

* Public Subnet：ALB / API Gateway
* Private Subnet：Lambda / ECS / SageMaker

### 4.3 サービス構成

| AWSサービス         | 用途    |
| --------------- | ----- |
| S3              | 画像保存  |
| Lambda          | 前後処理  |
| Rekognition     | 画像認識  |
| Textract        | OCR   |
| SageMaker       | 独自モデル |
| DynamoDB/Aurora | 業務DB  |

---

## 5. 非機能設計

### 5.1 性能設計

| 項目     | 要件   |
| ------ | ---- |
| 同期処理応答 | 3秒以内 |
| 非同期処理  | 〇分以内 |

### 5.2 可用性設計

* マルチAZ構成
* 単一障害点の排除

### 5.3 セキュリティ設計

* IAM最小権限
* S3 / DB / 通信の暗号化（KMS）
* WAFによる外部防御
* CloudTrailによる監査ログ

### 5.4 運用・監視設計

* CloudWatch Logs / Metrics
* アラート（SNS）
* 障害時手動対応フロー

---

## 6. AIモデル運用設計（MLOps）

### 6.1 モデル管理

* バージョン管理
* 本番／検証分離

### 6.2 再学習方針

* 定期再学習（〇ヶ月）
* 精度劣化検知

### 6.3 説明責任・判定ルール

* AI判断結果＋信頼度を保存
* 最終判断は業務ルール／人手

---

## 7. 障害・例外設計

### 7.1 障害パターン

| No | 事象     | 対応       |
| -- | ------ | -------- |
| 1  | AI応答なし | 再実行／手動処理 |
| 2  | 精度不足   | 人手確認     |

### 7.2 DLQ設計

* Lambda DLQ
* 再処理手順定義

---

## 8. 移行・リリース計画

* PoC → 本番移行条件
* 本番リリース手順
* ロールバック手順

---

## 9. 付録

* 用語集
* 参照資料
* 監査チェックリスト

---

このAWS画像分析システム設計書は **要件定義後〜基本設計レビュー〜監査説明資料**まで使える構成になっています。
特に以下を意識しています。

* **論理設計／物理設計を明確に分離**
* **AI特有の説明責任・再学習・人手介在ポイントを明文化**
* **金融・自治体で必ず突っ込まれる観点（監査・責任分界・代替フロー）を章立てで担保**

---
