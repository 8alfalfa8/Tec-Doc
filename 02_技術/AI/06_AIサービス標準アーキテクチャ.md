# ◆ AIサービス標準アーキテクチャ

以下に、**BtoB向けAIサービス**（**LLM／RAG前提**）**の**「**標準アーキテクチャ**（**実運用レベル**）」を<br>
👉 **事業化・継続利用・非AI企業対応**まで考慮した形で示します。

---

## AIサービス標準アーキテクチャ（全体図）

```
┌─────────────────────────────────────────────┐
│                 利用チャネル層               │
│                                             │
│  Web UI / 業務システム / Slack / API         │
│  ・既存業務ツールに埋め込み                   │
│  ・AI専用画面を作らない                       │
└───────────────▲─────────────────────────────┘
                │
┌───────────────┴─────────────────────────────┐
│            AIアプリケーション層               │
│                                             │
│  Prompt Orchestrator                        │
│  ・業務別プロンプトテンプレ                   │
│  ・入力バリデーション                         │
│  ・回答フォーマット強制                       │
│                                             │
│  Business Logic                             │
│  ・Human-in-the-Loop                        │
│  ・業務ルール適用                            │
│  ・承認/修正フロー                           │
└───────────────▲─────────────────────────────┘
                │
┌───────────────┴─────────────────────────────┐
│              LLM制御レイヤ                   │
│                                             │
│  Model Gateway                              │
│  ・OpenAI / Azure / OSS切替                  │
│  ・用途別モデル振分                           │
│  ・Token制御/コスト制御                      │
│                                             │
│  Fallback Logic                             │
│  ・回答不可判定                              │
│  ・代替モデル呼出                            │
└───────────────▲─────────────────────────────┘
                │
┌───────────────┴─────────────────────────────┐
│               RAG基盤レイヤ                  │
│                                             │
│  Retrieval Engine                           │
│  ・権限制御付き検索                           │
│  ・スコアリング                              │
│                                             │
│  Vector DB                                  │
│  ・Embeddingキャッシュ                       │
│  ・チャンク管理                              │
│                                             │
│  Knowledge Ingestion                        │
│  ・文書分割                                  │
│  ・メタデータ付与                            │
│  ・更新/論理削除                             │
└───────────────▲─────────────────────────────┘
                │
┌───────────────┴─────────────────────────────┐
│             データ・基幹連携層                │
│                                             │
│  正式データソース                            │
│  ・規程/手順書                               │
│  ・DB/CRM/ERP                               │
│                                             │
│  データガバナンス                            │
│  ・版管理                                   │
│  ・正規性定義                                │
└───────────────▲─────────────────────────────┘
                │
┌───────────────┴─────────────────────────────┐
│           運用・管理・事業基盤層              │
│                                             │
│  LLMOps / MLOps                             │
│  ・プロンプト管理                            │
│  ・精度評価                                  │
│                                             │
│  Logging / Monitoring                       │
│  ・質問/回答/修正履歴                         │
│  ・KPI/LTV分析                               │
│                                             │
│  Security / Governance                      │
│  ・マスキング                                │
│  ・権限管理                                  │
│  ・監査ログ                                  │
└─────────────────────────────────────────────┘
```

---

## レイヤ別の「狙い」と「実装ポイント」

### ① 利用チャネル層（非AI企業対応の要）

#### 狙い

* **AIを意識させない**
* 学習コストゼロ

#### 実装ポイント

* Slack／Teams／業務画面に自然埋め込み
* 「質問してください」ではなく<br>
  👉 **業務ボタン（要約／確認／提案）**

---

### ② AIアプリケーション層（業務適合の中核）

#### 狙い

* 精度より「使われる」

#### 実装ポイント

* プロンプトを**業務単位で固定**
* 回答フォーマットを強制
* 人の修正前提設計（責任分離）

---

### ③ LLM制御レイヤ（コスト・安定性）

#### 狙い

* ベンダーロックイン回避
* コスト爆発防止

#### 実装ポイント

* Model Gatewayで抽象化
* 「高精度モデルはここだけ」
* Token上限／月次制御

---

### ④ RAG基盤レイヤ（正確性の生命線）

#### 狙い

* ハルシネーション根絶

#### 実装ポイント

* 正式データのみ検索
* 権限別RAG（部門／役職）
* 根拠が無ければ「回答不可」

---

### ⑤ データ・基幹連携層（信頼の源泉）

#### 狙い

* 「どれが正しいか」をAIに教える

#### 実装ポイント

* 正規データ定義
* 更新時自動再Embedding
* 旧版の論理削除

---

### ⑥ 運用・事業基盤層（LTV最大化）

#### 狙い

* 売切型から脱却
* 継続改善＝価値

#### 実装ポイント

* 利用ログ → 改善提案
* 月次改善レポート
* 精度×利用率×業務効果の可視化

---

## このアーキテクチャで解決できる課題

| 課題      | 解決ポイント  |
| ------- | ------- |
| PoC止まり  | 業務KPI連動 |
| 精度不安    | RAG＋根拠  |
| 非AI企業   | UIで隠蔽   |
| 導入スピード  | テンプレ化   |
| LTV伸びない | 改善前提設計  |

---

